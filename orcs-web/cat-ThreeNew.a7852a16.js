(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{436:function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});var a=w(n(325)),i=w(n(55)),o=w(n(12)),s=w(n(28)),r=w(n(181)),l=w(n(34)),c=function(e,t,n){return t&&d(e.prototype,t),n&&d(e,n),e};function d(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}n(326),n(87),n(143),n(27),n(179),n(33);var u=n(20),p=n(24),m=w(n(5)),f=n(25),h=n(22),g=n(21),y=w(n(31));function w(e){return e&&e.__esModule?e:{default:e}}function v(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function x(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function b(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var k=l.default.confirm,T=r.default.TabPane,A="airLineAcftType.add",L="airLineAcftType.edit",C="airLineAcftType.del",S="airLineAcftType.export",R="newAirport.add",O="newAirport.edit",E="newAirport.del",F="newAirport.export",I="newAirLine.add",D="newAirLine.edit",B="newAirLine.del",N="newAirLine.export",P="newAcftType.add",M="newAcftType.edit",Y="newAcftType.del",H="newAcftType.export",K=(b(_,e.Component),c(_,[{key:"render",value:function(){var t=this.props.authority;return e.createElement(f.CardCommon,null,e.createElement(r.default,null,e.createElement(T,{tab:"新机型老航线",key:"1"},e.createElement(q,{authority:t})),e.createElement(T,{tab:"新开航机场",key:"2"},e.createElement(j,{authority:t})),e.createElement(T,{tab:"新开航线",key:"3"},e.createElement(U,{authority:t})),e.createElement(T,{tab:"新引进机型",key:"4"},e.createElement(Q,{authority:t}))))}}]),_);function _(e){v(this,_);var t=x(this,(_.__proto__||Object.getPrototypeOf(_)).call(this,e));return t.state={},t}var q=(b(V,e.Component),c(V,[{key:"componentDidMount",value:function(){this.getFleetTailMap(),this.getAllBranch(),this.getList()}},{key:"componentWillUnmount",value:function(){this.setState=function(e,t){}}},{key:"getFleetTailMap",value:function(){var e=this;(0,g.post)({url:"acfData/queryFleetTailMap",success:function(t){e.setState({fleetTailMap:t})}})}},{key:"getAllBranch",value:function(){var e=this;(0,g.post)({url:"acfData/getAllBranch",success:function(t){e.setState({allBranch:t})}})}},{key:"getSearchFormOptions",value:function(){return[{type:"Input",label:"关键字搜索",name:"airLineAcftTypeQuery",span:9,length:5,placeholder:"请输入航线、航线代码、机型、执行、备注搜索"}]}},{key:"getFormOptions",value:function(){var e=this.state,t=e.currentAction,n=e.currentData,a=e.fleetTailMap,i=e.allBranch,o=[];for(var s in a)o.push(s);var r=i.map(function(e){return e.chnDescShort}),l="add"==t?{}:JSON.parse(JSON.stringify(n));for(var s in l)"acftType"!=s&&"executeBase"!=s||!l[s]||"string"!=typeof l[s]||(l[s]=l[s].split(",")),"effFrom"!=s&&"effTill"!=s||(l[s]=l[s]?(0,m.default)(l[s]):null);return[{type:"Input",label:"航线",name:"airLineDesc",span:24,placeholder:"例：广州-伦敦",options:{initialValue:l.airLineDesc,rules:[{required:!0,message:"航线不可为空"},{pattern:/^[\u4e00-\u9fa5-]*$/,message:"请输入正确中文航线"}]}},{type:"Input",label:"航线代码",name:"airLineCode",span:24,placeholder:"例：CAN-LHR",options:{initialValue:l.airLineCode,rules:[{required:!0,message:"航线代码不可为空"},{pattern:/^[A-Z-]*$/,message:"请输入正确的航线代码"}]}},{type:"MultipleSelect",label:"机型",name:"acftType",list:o,span:24,options:{initialValue:l.acftType,rules:[{required:!0,message:"机型不可为空"},{validator:function(e,t,n){t&&t.value&&0==t.value.length&&n("机型不可为空"),n()}}]}},{type:"MultipleSelect",label:"执行",name:"executeBase",list:r,span:24,options:{initialValue:l.executeBase,rules:[{required:!0,message:"执行不可为空"},{validator:function(e,t,n){t&&t.value&&0==t.value.length&&n("执行不可为空"),n()}}]}},{type:"Input",label:"备注",name:"remark",span:24,options:{initialValue:l.remark}},{type:"TimeRangePicker",label:"有效时间",name:"effecTime",span:24,length:5,options:{initialValue:[(0,m.default)("00:00:00","HH:mm:ss"),(0,m.default)("11:59:59","HH:mm:ss")],rules:[{required:!0,message:"时间不可为空！"}]}}]}},{key:"render",value:function(){var t=this,n=this.state,s=n.table,r=n.modalOkBtnLoading,l=n.currentAction,c=n.selectedRowKeys,d=n.authorityList,u=n.authorityUpload,p=this.getSearchFormOptions(),m={aligin:"left",span:6,list:[{text:"查询",options:"queryOpt",event:this.search}]},g={table:s,onChange:this.getList,columns:this.columns,scroll:{x:"max-content"},rowSelection:{selectedRowKeys:c,onChange:function(e,n){t.onChecked(e,n)},onSelect:h.onSelect.bind(this),onSelectAll:h.onSelectAll.bind(this)}},y={options:{title:"add"==l?"新增":"edit"==l?"修改":"",width:"690px",okButtonProps:{loading:r}},onRef:function(e){t.modal=e},ok:this.submit.bind(this)},w=this.getFormOptions(),v=(0,f.getUploadProps)("airLineAcftType/importExcel",function(){t.getList({pageNum:1})});return e.createElement("div",{className:"card",style:{margin:0,padding:0}},d&&e.createElement(f.CommonForm,{options:p,btnOptions:m,wrappedComponentRef:function(e){e&&e.props&&e.props.form&&(t.searcForm=e.props.form)}}),e.createElement("div",{className:"buttons"},e.createElement(f.CommonBtns,{options:{shape:"round",size:"small"},btns:this.state.btns}),u&&e.createElement(a.default,v,e.createElement(i.default,{shape:"round",size:"small"},e.createElement(o.default,{type:"upload"}),"导入"))),d&&e.createElement(f.CommonTable,{options:g,onChecked:this.onChecked}),!d&&e.createElement("div",{className:"no-authority-box"},"无权限查看"),e.createElement(f.CommonModal,y,e.createElement("div",{className:"form-grid-5",style:{paddingLeft:"70px",paddingRight:"100px"}},e.createElement(f.CommonForm,{options:w,wrappedComponentRef:function(e){e&&e.props&&e.props.form&&(t.form=e.props.form)}}))))}}]),V);function V(e){v(this,V);var t=x(this,(V.__proto__||Object.getPrototypeOf(V)).call(this,e));return t.getList=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=t.state.table;n.setPage(e);var a=n.getParmaData();(0,g.post)({url:"airLineAcftType/queryAirLineAcftTypeListByParam",data:a,success:function(e){if(e&&e.rows){var i=e.rows.map(function(e,t){return e.index=(a.pageNum-1)*a.pageSize+t+1,e});n.setPage({dataList:i,total:e.total,pageNum:a.pageNum,pageSize:a.pageSize}),t.setState({table:n,selectedRowKeys:[],selectedRows:[],currentAction:"add"})}}})},t.onChecked=function(e,n){t.setState({selectedRowKeys:e,selectedRows:n})},t.search=function(){t.searcForm.validateFields(function(e,n){e||(n=(0,h.handleInParams)(n),t.getList({params:n,pageNum:1}))})},t.add=function(e){e(),t.setState({currentAction:"add"}),t.modal.show()},t.edit=function(e){0==t.state.selectedRows.length?(e(),s.default.warning("必须选择一个选项才能编辑！")):1<t.state.selectedRows.length?(e(),s.default.warning("只能选择一个选项！")):(e(),t.setState({currentAction:"edit",currentData:t.state.selectedRows[0]}),t.modal.show())},t.submit=function(){t.form.validateFields(function(e,n){if(e)t.setState({modalOkBtnLoading:!1});else{for(var a in t.setState({modalOkBtnLoading:!0}),n=(0,h.handleInParams)(n))if("acftType"==a||"executeBase"==a){n[a].value&&(n[a]=n[a].value);var i=n[a].indexOf("全部");-1<i&&n[a].splice(i,1)}var o,r;n.effecTime&&(n.effFrom=(0,m.default)(n.effecTime[0]).format("YYYY-MM-DD HH:mm:ss"),n.effTill=(0,m.default)(n.effecTime[1]).format("YYYY-MM-DD HH:mm:ss")),delete n.effecTime,r="add"==t.state.currentAction?(o="airLineAcftType/insert","添加成功"):(n.id=t.state.currentData.id,o="airLineAcftType/update","修改成功"),(0,g.post)({url:o,data:n,btn:function(){return t.setState({modalOkBtnLoading:!1})},success:function(e){s.default.success(r),t.modal.hide(),t.getList({pageNum:1}),t.setState({selectedRowKeys:[],selectedRows:[],selectedExport:[]})}})}})},t.del=function(e){if(0==t.state.selectedRows.length)e(),s.default.warning("请至少选择一行数据");else{var n=t.state.selectedRows.map(function(e){return e.id}),a=t.state.selectedRows.map(function(e){return e.airLineDesc});k({title:"确认删除"+a.join("、")+"航线吗?",okType:"danger",onOk:function(){(0,g.post)({url:"airLineAcftType/delete",data:{ids:n},btn:e,success:function(e){s.default.success("删除成功"),t.getList({pageNum:1}),t.setState({selectedRowKeys:[],selectedRows:[],selectedExport:[]})}})},onCancel:e})}},t.export=function(e){if(0==t.state.selectedExport.length)e(),s.default.warning("未选中选项");else{var n=t.state.selectedExport.map(function(e){return e.id}),a=t.state.selectedExport.map(function(e){return e.airLineDesc});k({title:"确定导出"+a.join("、")+"的航线吗？",onOk:function(){(0,g.post)({url:"airLineAcftType/export",data:{ids:n},btn:e,success:function(e){(0,h.downloadFile)(e,"新机型老航线表")}})},onCancel:e})}},t.exportAll=function(e){var n=t;k({title:"确定导出全部航线吗？",onOk:function(){var t=(0,h.handleInParams)(n.searcForm.getFieldsValue());(0,g.post)({url:"airLineAcftType/export",data:t,btn:e,success:function(e){(0,h.downloadFile)(e,"新机型老航线表")}})},onCancel:e})},t.state={table:new y.default,selectedRowKeys:[],selectedRows:[],selectedExport:[],btns:[{name:"新增",id:A,icon:"plus-circle",onClick:t.add},{name:"修改",id:L,icon:"edit",onClick:t.edit},{name:"删除",id:C,icon:"minus-circle",onClick:t.del},{name:"导出",id:S,icon:"export",onClick:t.export},{name:"导出全部",id:S,icon:"export",onClick:t.exportAll}].filter(function(t){return(0,h.isAuthority)(t.id,e.authority)}),authorityList:(0,h.isAuthority)("airLineAcftType.list",e.authority),authorityUpload:(0,h.isAuthority)("airLineAcftType.upload",e.authority),modalOkBtnLoading:!1,currentAction:"",currentData:{},fleetTailMap:{},allBranch:[]},t.columns=[{title:"序号",dataIndex:"index",width:50},{title:"航线",dataIndex:"airLineDesc",width:150},{title:"航线代码",dataIndex:"airLineCode",width:150},{title:"机型",dataIndex:"acftType",width:100,isTooltip:!0},{title:"执行",dataIndex:"executeBase",width:100},{title:"备注",dataIndex:"remark",width:120,isTooltip:!0},{title:"生效时间",dataIndex:"effFrom",width:120},{title:"失效时间",dataIndex:"effTill",width:120},{title:"更新时间",dataIndex:"updateTime",width:150},{title:"更新人",dataIndex:"updateUser",width:100}],t.modal,t.form,t}var j=(b(z,e.Component),c(z,[{key:"componentDidMount",value:function(){this.getList()}},{key:"componentWillUnmount",value:function(){this.setState=function(e,t){}}},{key:"getSearchFormOptions",value:function(){return[{type:"Input",label:"关键字搜索",name:"newAirportQuery",span:8,length:5,placeholder:"请输入新开航机场、备注搜索"}]}},{key:"getFormOptions",value:function(){var e=this.state,t=e.currentAction,n=e.currentData,a="add"==t?{}:JSON.parse(JSON.stringify(n));for(var i in a)"effFrom"!=i&&"effTill"!=i||(a[i]=a[i]?(0,m.default)(a[i]):null);return[{type:"Input",label:"新开航机场",name:"icaoCode",span:24,options:{initialValue:a.icaoCode,rules:[{required:!0,message:"新开航机场不可为空"}]}},{type:"Input",label:"备注",name:"remark",span:24,options:{initialValue:a.remark}},{type:"TimeRangePicker",label:"有效时间",name:"effecTime",span:24,length:5,options:{initialValue:[(0,m.default)("00:00:00","HH:mm:ss"),(0,m.default)("11:59:59","HH:mm:ss")],rules:[{required:!0,message:"时间不可为空！"}]}}]}},{key:"render",value:function(){var t=this,n=this.state,a=n.table,i=n.modalOkBtnLoading,o=n.currentAction,s=n.selectedRowKeys,r=n.authorityList,l=this.getSearchFormOptions(),c={aligin:"left",span:6,list:[{text:"查询",options:"queryOpt",event:this.search}]},d={table:a,onChange:this.getList,columns:this.columns,scroll:{x:"max-content"},rowSelection:{selectedRowKeys:s,onChange:function(e,n){t.onChecked(e,n)},onSelect:h.onSelect.bind(this),onSelectAll:h.onSelectAll.bind(this)}},u={options:{title:"add"==o?"新增":"edit"==o?"修改":"",width:"705px",okButtonProps:{loading:i}},onRef:function(e){t.modal=e},ok:this.submit.bind(this)},p=this.getFormOptions();return e.createElement("div",{className:"card",style:{margin:0,padding:0}},r&&e.createElement(f.CommonForm,{options:l,btnOptions:c,wrappedComponentRef:function(e){e&&e.props&&e.props.form&&(t.searcForm=e.props.form)}}),e.createElement("div",{className:"buttons"},e.createElement(f.CommonBtns,{options:{shape:"round",size:"small"},btns:this.state.btns})),r&&e.createElement(f.CommonTable,{options:d,onChecked:this.onChecked}),!r&&e.createElement("div",{className:"no-authority-box"},"无权限查看"),e.createElement(f.CommonModal,u,e.createElement("div",{className:"form-grid-6",style:{paddingLeft:"70px",paddingRight:"100px"}},e.createElement(f.CommonForm,{options:p,wrappedComponentRef:function(e){e&&e.props&&e.props.form&&(t.form=e.props.form)}}))))}}]),z);function z(e){v(this,z);var t=x(this,(z.__proto__||Object.getPrototypeOf(z)).call(this,e));return t.getList=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=t.state.table;n.setPage(e);var a=n.getParmaData();(0,g.post)({url:"newAirport/queryNewAirportListByParam",data:a,success:function(e){if(e&&e.rows){var i=e.rows.map(function(e,t){return e.index=(a.pageNum-1)*a.pageSize+t+1,e});n.setPage({dataList:i,total:e.total,pageNum:a.pageNum,pageSize:a.pageSize}),t.setState({table:n,selectedRowKeys:[],selectedRows:[],currentAction:"add"})}}})},t.onChecked=function(e,n){t.setState({selectedRowKeys:e,selectedRows:n})},t.search=function(){t.searcForm.validateFields(function(e,n){e||(n=(0,h.handleInParams)(n),t.getList({params:n,pageNum:1}))})},t.add=function(e){e(),t.setState({currentAction:"add"}),t.modal.show()},t.edit=function(e){0==t.state.selectedRows.length?(e(),s.default.warning("必须选择一个选项才能编辑！")):1<t.state.selectedRows.length?(e(),s.default.warning("只能选择一个选项！")):(e(),t.setState({currentAction:"edit",currentData:t.state.selectedRows[0]}),t.modal.show())},t.submit=function(){t.setState({modalOkBtnLoading:!0}),t.form.validateFields(function(e,n){var a,i;e?t.setState({modalOkBtnLoading:!1}):((n=(0,h.handleInParams)(n)).effecTime&&(n.effFrom=(0,m.default)(n.effecTime[0]).format("YYYY-MM-DD HH:mm:ss"),n.effTill=(0,m.default)(n.effecTime[1]).format("YYYY-MM-DD HH:mm:ss")),delete n.effecTime,i="add"==t.state.currentAction?(a="newAirport/insert","添加成功"):(n.id=t.state.currentData.id,a="newAirport/update","修改成功"),(0,g.post)({url:a,data:n,btn:function(){return t.setState({modalOkBtnLoading:!1})},success:function(e){s.default.success(i),t.modal.hide(),t.getList({pageNum:1}),t.setState({selectedRowKeys:[],selectedRows:[],selectedExport:[]})}}))})},t.del=function(e){if(0==t.state.selectedRows.length)e(),s.default.warning("请至少选择一行数据");else{var n=t.state.selectedRows.map(function(e){return e.id}),a=t.state.selectedRows.map(function(e){return e.icaoCode});k({title:"确认删除"+a.join("、")+"吗?",okType:"danger",onOk:function(){(0,g.post)({url:"newAirport/delete",data:{ids:n},btn:e,success:function(e){s.default.success("删除成功"),t.getList({pageNum:1}),t.setState({selectedRowKeys:[],selectedRows:[],selectedExport:[]})}})},onCancel:e})}},t.export=function(e){if(0==t.state.selectedExport.length)e(),s.default.warning("未选中选项");else{var n=t.state.selectedExport.map(function(e){return e.id}),a=t.state.selectedExport.map(function(e){return e.icaoCode});k({title:"确定导出"+a.join("、")+"的新开航机场吗？",onOk:function(){(0,g.post)({url:"newAirport/export",data:{ids:n},btn:e,success:function(e){(0,h.downloadFile)(e,"新开航机场表")}})},onCancel:e})}},t.exportAll=function(e){var n=t;k({title:"确定导出全部新开航机场吗？",onOk:function(){var t=(0,h.handleInParams)(n.searcForm.getFieldsValue());(0,g.post)({url:"newAirport/export",data:t,btn:e,success:function(e){(0,h.downloadFile)(e,"新开航机场表")}})},onCancel:e})},t.state={table:new y.default,selectedRowKeys:[],selectedRows:[],selectedExport:[],btns:[{name:"新增",id:R,icon:"plus-circle",onClick:t.add},{name:"修改",id:O,icon:"edit",onClick:t.edit},{name:"删除",id:E,icon:"minus-circle",onClick:t.del},{name:"导出",id:F,icon:"export",onClick:t.export},{name:"导出全部",id:F,icon:"export",onClick:t.exportAll}].filter(function(t){return(0,h.isAuthority)(t.id,e.authority)}),authorityList:(0,h.isAuthority)("newAirport.list",e.authority),modalOkBtnLoading:!1,currentAction:"",currentData:{}},t.columns=[{title:"序号",dataIndex:"index",width:50},{title:"新开航机场",dataIndex:"icaoCode",width:150},{title:"备注",dataIndex:"remark",width:120,isTooltip:!0},{title:"生效时间",dataIndex:"effFrom",width:120},{title:"失效时间",dataIndex:"effTill",width:120},{title:"更新时间",dataIndex:"updateTime",width:150},{title:"更新人",dataIndex:"updateUser",width:100}],t.modal,t.form,t}var U=(b(J,e.Component),c(J,[{key:"componentDidMount",value:function(){this.getFleetTailMap(),this.getAllBranch(),this.getList()}},{key:"componentWillUnmount",value:function(){this.setState=function(e,t){}}},{key:"getFleetTailMap",value:function(){var e=this;(0,g.post)({url:"acfData/queryFleetTailMap",success:function(t){e.setState({fleetTailMap:t})}})}},{key:"getAllBranch",value:function(){var e=this;(0,g.post)({url:"acfData/getAllBranch",success:function(t){e.setState({allBranch:t})}})}},{key:"getSearchFormOptions",value:function(){return[{type:"Input",label:"关键字搜索",name:"newAirLineQuery",span:12,length:5,placeholder:"请输入航线变化、航线、航线代码、机型、执行、备注、预计开航时间搜索"}]}},{key:"getFormOptions",value:function(){var e=this.state,t=e.currentAction,n=e.currentData,a=e.fleetTailMap,i=e.allBranch,o="add"==t?{}:JSON.parse(JSON.stringify(n));for(var s in o)"acftType"!=s&&"executeBase"!=s||!o[s]||"string"!=typeof o[s]||(o[s]=o[s].split(",")),"expectStart"!=s&&"effFrom"!=s&&"effTill"!=s||(o[s]=o[s]?(0,m.default)(o[s]):null);var r=[];for(var s in a)r.push(s);var l=i.map(function(e){return e.chnDescShort});return[{type:"Input",label:"航线变化",name:"airLineChange",span:24,options:{initialValue:o.airLineChange}},{type:"Input",label:"航线",name:"airLineDesc",span:24,options:{initialValue:o.airLineDesc,rules:[{required:!0,message:"航线不可为空"},{pattern:/^[\u4e00-\u9fa5-]*$/,message:"请输入正确中文航线"}]}},{type:"Input",label:"航线代码",name:"airLineCode",span:24,options:{initialValue:o.airLineCode,rules:[{required:!0,message:"航线代码不可为空"},{pattern:/^[A-Z-]*$/,message:"请输入正确的航线代码"}]}},{type:"MultipleSelect",label:"机型",name:"acftType",list:r,span:24,options:{initialValue:o.acftType,rules:[{required:!0,message:"机型不可为空"},{validator:function(e,t,n){t&&t.value&&0==t.value.length&&n("机型不可为空"),n()}}]}},{type:"MultipleSelect",label:"执行",name:"executeBase",list:l,span:24,options:{initialValue:o.executeBase,rules:[{required:!0,message:"执行不可为空"},{validator:function(e,t,n){t&&t.value&&0==t.value.length&&n("执行不可为空"),n()}}]}},{type:"Input",label:"备注",name:"remark",span:24,options:{initialValue:o.remark}},{type:"DatePicker",label:"预计开航时间",name:"expectStart",span:24,options:{initialValue:o.expectStart}},{type:"TimeRangePicker",label:"有效时间",name:"effecTime",span:24,length:5,options:{initialValue:[(0,m.default)("00:00:00","HH:mm:ss"),(0,m.default)("11:59:59","HH:mm:ss")],rules:[{required:!0,message:"时间不可为空！"}]}}]}},{key:"render",value:function(){var t=this,n=this.state,s=n.table,r=n.modalOkBtnLoading,l=n.currentAction,c=n.selectedRowKeys,d=n.authorityList,u=n.authorityUpload,p=this.getSearchFormOptions(),m={aligin:"left",span:6,list:[{text:"查询",options:"queryOpt",event:this.search}]},g={table:s,onChange:this.getList,columns:this.columns,scroll:{x:"max-content"},rowSelection:{selectedRowKeys:c,onChange:function(e,n){t.onChecked(e,n)},onSelect:h.onSelect.bind(this),onSelectAll:h.onSelectAll.bind(this)}},y={options:{title:"add"==l?"新增":"edit"==l?"修改":"",width:"705px",okButtonProps:{loading:r}},onRef:function(e){t.modal=e},ok:this.submit.bind(this)},w=this.getFormOptions(),v=(0,f.getUploadProps)("newAirLine/importExcel",function(){t.getList({pageNum:1})});return e.createElement("div",{className:"card",style:{margin:0,padding:0}},d&&e.createElement(f.CommonForm,{options:p,btnOptions:m,wrappedComponentRef:function(e){e&&e.props&&e.props.form&&(t.searcForm=e.props.form)}}),e.createElement("div",{className:"buttons"},e.createElement(f.CommonBtns,{options:{shape:"round",size:"small"},btns:this.state.btns}),u&&e.createElement(a.default,v,e.createElement(i.default,{shape:"round",size:"small"},e.createElement(o.default,{type:"upload"}),"导入"))),d&&e.createElement(f.CommonTable,{options:g,onChecked:this.onChecked}),e.createElement(f.CommonModal,y,e.createElement("div",{className:"form-grid-6",style:{paddingLeft:"70px",paddingRight:"100px"}},e.createElement(f.CommonForm,{options:w,wrappedComponentRef:function(e){e&&e.props&&e.props.form&&(t.form=e.props.form)}}))))}}]),J);function J(e){v(this,J);var t=x(this,(J.__proto__||Object.getPrototypeOf(J)).call(this,e));return t.getList=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=t.state.table;n.setPage(e);var a=n.getParmaData();(0,g.post)({url:"newAirLine/queryNewAirLineListByParam",data:a,success:function(e){if(e&&e.rows){var i=e.rows.map(function(e,t){return e.index=(a.pageNum-1)*a.pageSize+t+1,e});n.setPage({dataList:i,total:e.total,pageNum:a.pageNum,pageSize:a.pageSize}),t.setState({table:n,selectedRowKeys:[],selectedRows:[],currentAction:"add"})}}})},t.onChecked=function(e,n){t.setState({selectedRowKeys:e,selectedRows:n})},t.search=function(){t.searcForm.validateFields(function(e,n){e||(n=(0,h.handleInParams)(n),t.getList({params:n,pageNum:1}))})},t.add=function(e){e(),t.setState({currentAction:"add"}),t.modal.show()},t.edit=function(e){0==t.state.selectedRows.length?(e(),s.default.warning("必须选择一个选项才能编辑！")):1<t.state.selectedRows.length?(e(),s.default.warning("只能选择一个选项！")):(e(),t.setState({currentAction:"edit",currentData:t.state.selectedRows[0]}),t.modal.show())},t.submit=function(){t.setState({modalOkBtnLoading:!0}),t.form.validateFields(function(e,n){if(e)t.setState({modalOkBtnLoading:!1});else{for(var a in n=(0,h.handleInParams)(n)){if("acftType"==a||"executeBase"==a){n[a].value&&(n[a]=n[a].value);var i=n[a].indexOf("全部");-1<i&&n[a].splice(i,1)}"expectStart"==a&&(n[a]=(0,m.default)(n[a]).format("YYYY-MM-DD"))}var o,r;n.effecTime&&(n.effFrom=(0,m.default)(n.effecTime[0]).format("YYYY-MM-DD HH:mm:ss"),n.effTill=(0,m.default)(n.effecTime[1]).format("YYYY-MM-DD HH:mm:ss")),delete n.effecTime,r="add"==t.state.currentAction?(o="newAirLine/insert","添加成功"):(n.id=t.state.currentData.id,o="newAirLine/update","修改成功"),(0,g.post)({url:o,data:n,btn:function(){return t.setState({modalOkBtnLoading:!1})},success:function(e){s.default.success(r),t.modal.hide(),t.getList({pageNum:1}),t.setState({selectedRowKeys:[],selectedRows:[],selectedExport:[]})}})}})},t.del=function(e){if(0==t.state.selectedRows.length)e(),s.default.warning("请至少选择一行数据");else{var n=t.state.selectedRows.map(function(e){return e.id}),a=t.state.selectedRows.map(function(e){return e.airLineDesc});k({title:"确认删除"+a.join("、")+"航线吗?",okType:"danger",onOk:function(){(0,g.post)({url:"newAirLine/delete",data:{ids:n},btn:e,success:function(e){s.default.success("删除成功"),t.getList({pageNum:1}),t.setState({selectedRowKeys:[],selectedRows:[],selectedExport:[]})}})},onCancel:e})}},t.export=function(e){if(0==t.state.selectedExport.length)e(),s.default.warning("未选中选项");else{var n=t.state.selectedExport.map(function(e){return e.id}),a=t.state.selectedExport.map(function(e){return e.airLineDesc});k({title:"确定导出"+a.join("、")+"的新开航航线吗？",onOk:function(){(0,g.post)({url:"newAirLine/export",data:{ids:n},btn:e,success:function(e){(0,h.downloadFile)(e,"新开航线表")}})},onCancel:e})}},t.exportAll=function(e){var n=t;k({title:"确定导出全部新开航航线吗？",onOk:function(){var t=(0,h.handleInParams)(n.searcForm.getFieldsValue());(0,g.post)({url:"newAirLine/export",data:t,btn:e,success:function(e){(0,h.downloadFile)(e,"新开航线表")}})},onCancel:e})},t.state={table:new y.default,selectedRowKeys:[],selectedRows:[],selectedExport:[],btns:[{name:"新增",id:I,icon:"plus-circle",onClick:t.add},{name:"修改",id:D,icon:"edit",onClick:t.edit},{name:"删除",id:B,icon:"minus-circle",onClick:t.del},{name:"导出",id:N,icon:"export",onClick:t.export},{name:"导出全部",id:N,icon:"export",onClick:t.exportAll}].filter(function(t){return(0,h.isAuthority)(t.id,e.authority)}),authorityList:(0,h.isAuthority)("newAirLine.list",e.authority),authorityUpload:(0,h.isAuthority)("newAirLine.upload",e.authority),modalOkBtnLoading:!1,currentAction:"",currentData:{},fleetTailMap:{},allBranch:[]},t.columns=[{title:"序号",dataIndex:"index",width:50},{title:"航线变化",dataIndex:"airLineChange",width:150,isTooltip:!0},{title:"航线",dataIndex:"airLineDesc",width:150},{title:"航线代码",dataIndex:"airLineCode",width:150},{title:"机型",dataIndex:"acftType",width:100},{title:"执行",dataIndex:"executeBase",width:100},{title:"备注",dataIndex:"remark",width:120,isTooltip:!0},{title:"预计开航时间",dataIndex:"expectStart",width:120},{title:"生效时间",dataIndex:"effFrom",width:120},{title:"失效时间",dataIndex:"effTill",width:120},{title:"更新时间",dataIndex:"updateTime",width:150},{title:"更新人",dataIndex:"updateUser",width:100}],t.modal,t.form,t}var Q=(b(W,e.Component),c(W,[{key:"componentDidMount",value:function(){this.getComboTree(),this.getList()}},{key:"componentWillUnmount",value:function(){this.setState=function(e,t){}}},{key:"handleComboTree",value:function(e){for(var t=0;t<e.length;t++)e[t].title=e[t].text,e[t].value=e[t].id,e[t].key=e[t].id,e[t].children&&(e[t].children=this.handleComboTree(e[t].children));return e}},{key:"getComboTree",value:function(){var e=this;(0,g.post)({url:"newAcftType/comboTree",success:function(t){if(t){var n=e.handleComboTree(JSON.parse(t));e.setState({comboTree:n})}}})}},{key:"getIdByText",value:function(e){var t="";return function e(n,a){if(n&&n.length){for(var i=0;i<n.length;i++){var o=n[i].children;n[i].text===a&&(t=n[i].id),o&&0<o.length&&e(o,a)}return t}}(this.state.comboTree,e),t}},{key:"getTextById",value:function(e){var t="";return function e(n,a){if(n&&n.length){for(var i=0;i<n.length;i++){var o=n[i].children;n[i].id===a&&(t=n[i].text),o&&0<o.length&&e(o,a)}return t}}(this.state.comboTree,e),t}},{key:"getSearchFormOptions",value:function(){return[{type:"Input",label:"关键字搜索",name:"newAcftTypeQuery",span:6,length:5,placeholder:"请输入动态机型、备注搜索"}]}},{key:"getFormOptions",value:function(){var e=this.state,t=e.currentAction,n=e.currentData,a=e.comboTree,i="add"==t?{}:JSON.parse(JSON.stringify(n));for(var o in i)"effFrom"!=o&&"effTill"!=o||(i[o]=i[o]?(0,m.default)(i[o]):i[o]);return[{type:"TreeSelect",label:"动态机型",name:"acftType",list:a,span:24,options:{initialValue:this.getIdByText(i.acftType),rules:[{required:!0,message:"动态机型不可为空"}]}},{type:"Input",label:"备注",name:"remark",span:24,options:{initialValue:i.remark}},{type:"TimeRangePicker",label:"有效时间",name:"effecTime",span:24,length:5,options:{initialValue:[(0,m.default)("00:00:00","HH:mm:ss"),(0,m.default)("11:59:59","HH:mm:ss")],rules:[{required:!0,message:"时间不可为空！"}]}}]}},{key:"render",value:function(){var t=this,n=this.state,a=n.table,i=n.modalOkBtnLoading,o=n.currentAction,s=n.selectedRowKeys,r=n.authorityList,l=this.getSearchFormOptions(),c={aligin:"left",span:6,list:[{text:"查询",options:"queryOpt",event:this.search}]},d={table:a,onChange:this.getList,columns:this.columns,scroll:{x:"max-content"},rowSelection:{selectedRowKeys:s,onChange:function(e,n){t.onChecked(e,n)},onSelect:h.onSelect.bind(this),onSelectAll:h.onSelectAll.bind(this)}},u={options:{title:"add"==o?"新增":"edit"==o?"修改":"",width:"690px",okButtonProps:{loading:i}},onRef:function(e){t.modal=e},ok:this.submit.bind(this)},p=this.getFormOptions();return e.createElement("div",{className:"card",style:{margin:0,padding:0}},r&&e.createElement(f.CommonForm,{options:l,btnOptions:c,wrappedComponentRef:function(e){e&&e.props&&e.props.form&&(t.searcForm=e.props.form)}}),e.createElement("div",{className:"buttons"},e.createElement(f.CommonBtns,{options:{shape:"round",size:"small"},btns:this.state.btns})),r&&e.createElement(f.CommonTable,{options:d,onChecked:this.onChecked}),!r&&e.createElement("div",{className:"no-authority-box"},"无权限查看"),e.createElement(f.CommonModal,u,e.createElement("div",{className:"form-grid-5",style:{paddingLeft:"70px",paddingRight:"100px"}},e.createElement(f.CommonForm,{options:p,wrappedComponentRef:function(e){e&&e.props&&e.props.form&&(t.form=e.props.form)}}))))}}]),W);function W(e){v(this,W);var t=x(this,(W.__proto__||Object.getPrototypeOf(W)).call(this,e));return t.getList=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=t.state.table;n.setPage(e);var a=n.getParmaData();(0,g.post)({url:"newAcftType/queryNewAcftTypeListByParam",data:a,success:function(e){if(e&&e.rows){var i=e.rows.map(function(e,t){return e.index=(a.pageNum-1)*a.pageSize+t+1,e});n.setPage({dataList:i,total:e.total,pageNum:a.pageNum,pageSize:a.pageSize}),t.setState({table:n,selectedRowKeys:[],selectedRows:[],currentAction:"add"})}}})},t.onChecked=function(e,n){t.setState({selectedRowKeys:e,selectedRows:n})},t.search=function(){t.searcForm.validateFields(function(e,n){e||(n=(0,h.handleInParams)(n),t.getList({params:n,pageNum:1}))})},t.add=function(e){e(),t.setState({currentAction:"add"}),t.modal.show()},t.edit=function(e){0==t.state.selectedRows.length?(e(),s.default.warning("必须选择一个选项才能编辑！")):1<t.state.selectedRows.length?(e(),s.default.warning("只能选择一个选项！")):(e(),t.setState({currentAction:"edit",currentData:t.state.selectedRows[0]}),t.modal.show())},t.submit=function(){t.setState({modalOkBtnLoading:!0}),t.form.validateFields(function(e,n){if(e)t.setState({modalOkBtnLoading:!1});else{for(var a in n=(0,h.handleInParams)(n))"acftType"==a&&(n[a]=t.getTextById(n[a]));var i,o;n.effecTime&&(n.effFrom=(0,m.default)(n.effecTime[0]).format("YYYY-MM-DD HH:mm:ss"),n.effTill=(0,m.default)(n.effecTime[1]).format("YYYY-MM-DD HH:mm:ss")),delete n.effecTime,o="add"==t.state.currentAction?(i="newAcftType/insert","添加成功"):(n.id=t.state.currentData.id,i="newAcftType/update","修改成功"),(0,g.post)({url:i,data:n,btn:function(){return t.setState({modalOkBtnLoading:!1})},success:function(e){s.default.success(o),t.modal.hide(),t.getList({pageNum:1}),t.setState({selectedRowKeys:[],selectedRows:[],selectedExport:[]})}})}})},t.del=function(e){if(0==t.state.selectedRows.length)e(),s.default.warning("请至少选择一行数据");else{var n=t.state.selectedRows.map(function(e){return e.id}),a=t.state.selectedRows.map(function(e){return e.acftType});k({title:"确认删除"+a.join("、")+"吗?",okType:"danger",onOk:function(){(0,g.post)({url:"newAcftType/delete",data:{ids:n},btn:e,success:function(e){s.default.success("删除成功"),t.getList({pageNum:1}),t.setState({selectedRowKeys:[],selectedRows:[],selectedExport:[]})}})},onCancel:e})}},t.export=function(e){if(0==t.state.selectedExport.length)e(),s.default.warning("未选中选项");else{var n=t.state.selectedExport.map(function(e){return e.id}),a=t.state.selectedExport.map(function(e){return e.acftType});k({title:"确定导出"+a.join("、")+"的新引进机型吗？",onOk:function(){(0,g.post)({url:"newAcftType/export",data:{ids:n},btn:e,success:function(e){(0,h.downloadFile)(e,"新引进机型表")}})},onCancel:e})}},t.exportAll=function(e){var n=t;k({title:"确定导出全部新引进机型吗？",onOk:function(){var t=(0,h.handleInParams)(n.searcForm.getFieldsValue());(0,g.post)({url:"newAcftType/export",data:t,btn:e,success:function(e){(0,h.downloadFile)(e,"新引进机型表")}})},onCancel:e})},t.state={table:new y.default,selectedRowKeys:[],selectedRows:[],selectedExport:[],btns:[{name:"新增",id:P,icon:"plus-circle",onClick:t.add},{name:"修改",id:M,icon:"edit",onClick:t.edit},{name:"删除",id:Y,icon:"minus-circle",onClick:t.del},{name:"导出",id:H,icon:"export",onClick:t.export},{name:"导出全部",id:H,icon:"export",onClick:t.exportAll}].filter(function(t){return(0,h.isAuthority)(t.id,e.authority)}),authorityList:(0,h.isAuthority)("newAcftType.list",e.authority),modalOkBtnLoading:!1,currentAction:"",currentData:{},comboTree:[]},t.columns=[{title:"序号",dataIndex:"index",width:50},{title:"动态机型",dataIndex:"acftType",width:100},{title:"备注",dataIndex:"remark",width:120,isTooltip:!0},{title:"生效时间",dataIndex:"effFrom",width:120},{title:"失效时间",dataIndex:"effTill",width:120},{title:"更新时间",dataIndex:"updateTime",width:150},{title:"更新人",dataIndex:"updateUser",width:100}],t.modal,t.form,t}t.default=(0,p.connect)(function(e){return{authority:e.authority}})((0,u.withRouter)(K))}).call(this,n(1))}}]);
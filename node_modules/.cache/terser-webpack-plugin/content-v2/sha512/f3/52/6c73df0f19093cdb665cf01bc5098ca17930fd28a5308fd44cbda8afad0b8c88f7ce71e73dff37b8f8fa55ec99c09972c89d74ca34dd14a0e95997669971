{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{410:function(t,e,n){\"use strict\";(function(t){Object.defineProperty(e,\"__esModule\",{value:!0});var a=p(n(28)),r=p(n(77));function o(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,\"value\"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}n(27),n(76);var i=n(20),s=n(25),u=p(n(5)),l=n(26),c=n(23),m=n(22),f=p(n(33));function p(t){return t&&t.__esModule?t:{default:t}}var h=r.default.TextArea,d=(function(t,e){if(\"function\"!=typeof e&&null!==e)throw new TypeError(\"Super expression must either be null or a function, not \"+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(g,t.Component),function(t,e,n){e&&o(t.prototype,e),n&&o(t,n)}(g,[{key:\"componentDidMount\",value:function(){this.columns=(0,l.riskWarnListColumns)(!1,this.onClickSure),this.getData()}},{key:\"componentWillUnmount\",value:function(){this.setState=function(t,e){}}},{key:\"onSelectTab\",value:function(t){this.currentStatus=t.status;var e=1==this.currentStatus;this.columns=(0,l.riskWarnListColumns)(e,this.onClickSure),this.getList()}},{key:\"getData\",value:function(){var t=this;(0,m.post)({url:\"rmRiskWarn/queryRiskWarnAll\",success:function(e){t.setState({form:e}),t.onSelectTab(t.state.tabs[0])}})}},{key:\"handleSearchParams\",value:function(t){var e=(0,c.handleInParams)(t);for(var n in e)\"date\"==n&&2==e[n].length&&(e.start=(0,u.default)(e[n][0]).format(\"YYYY-MM-DD\"),e.end=(0,u.default)(e[n][1]).format(\"YYYY-MM-DD\"),delete e[n]),\"latestEqpCds\"==n&&(e[n]=e[n].value?e[n].value:e[n]);return e}},{key:\"getFormOptions\",value:function(){var t=this,e=this.state.form.userBelongsToCompany,n=this.state.form.branchInfoList.filter(function(t){if(\"NHZ\"==e){if(\"CKG\"!=t.branchCd)return t}else if(t.branchCd==e)return t}).map(function(t,e){return{key:t.branchCd,text:t.branchCd+t.chnDescShort}}),a=this.state.form.fleetGrpList.map(function(t){return{label:t.fleetGrpCd,value:t.fleetGrpCd}});return[{type:\"RangePicker\",label:\"航班日期\",name:\"date\",span:8},{type:\"Select\",label:\"公司\",name:\"comp\",span:function(){return t.form&&\"\"==t.form.getFieldValue(\"comp\")?8:5},list:n,isHasAllSelect:!1,options:{initialValue:e}},{type:\"Select\",label:\"\",name:\"condition\",span:3,list:[{key:\"conditionTailNr\",text:\"按飞机\"},{key:\"conditionBranchCode\",text:\"按航班\"},{key:\"crew\",text:\"按机组\"}],options:{initialValue:\"conditionBranchCode\"},isHasAllSelect:!1,hide:function(){return!(!t.form||\"\"!=t.form.getFieldValue(\"comp\"))}},{type:\"Input\",label:\"航班号\",name:\"fltNr\",span:6,placeholder:\"航班号\"},{type:\"CheckboxCustom\",label:\"机型组\",name:\"latestEqpCds\",span:24,list:a,options:{initialValue:a.map(function(t){return t.value})}}]}},{key:\"render\",value:function(){var e=this,n=this.getFormOptions(),a={aligin:\"center\",span:24,list:[{text:\"查询\",options:\"queryOpt\",event:this.submit},{text:\"重置\",options:\"resetOpt\",event:this.reset}]},r=this.state,o=r.table,i=r.modalOkBtnLoading,s=r.authorityList,u=r.authorityListHistory,c={notCheck:!0,table:o,columns:this.columns,onChange:this.getList},m={options:{title:\"告警处理备注\",okButtonProps:{loading:i}},ok:this.warnSure.bind(this),onRef:function(t){e.modal=t}};return t.createElement(l.CardCommon,null,t.createElement(\"div\",{className:\"tab-wrap\"},this.state.tabs.map(function(n,a){return t.createElement(\"div\",{key:a,className:n.status==e.currentStatus?\"active\":\"\",onClick:function(){return e.onSelectTab(n)}},n.name)})),s&&0==this.currentStatus&&t.createElement(t.Fragment,null,t.createElement(l.CommonForm,{options:n,btnOptions:a,wrappedComponentRef:function(t){t&&t.props&&t.props.form&&(e.form=t.props.form)}}),t.createElement(l.CommonTable,{options:c,onChecked:this.onChecked}),t.createElement(l.CommonModal,m,t.createElement(h,{rows:4,value:this.state.warningRemark,onChange:function(t){var n=t.target.value;return e.setState({warningRemark:n})},autoComplete:\"off\"}))),!s&&0==this.currentStatus&&t.createElement(\"div\",{className:\"no-authority-box\"},\"无权限查看\"),u&&1==this.currentStatus&&t.createElement(t.Fragment,null,t.createElement(l.CommonForm,{options:n,btnOptions:a,wrappedComponentRef:function(t){t&&t.props&&t.props.form&&(e.form=t.props.form)}}),t.createElement(l.CommonTable,{options:c,onChecked:this.onChecked}),t.createElement(l.CommonModal,m,t.createElement(h,{rows:4,value:this.state.warningRemark,onChange:function(t){var n=t.target.value;return e.setState({warningRemark:n})},autoComplete:\"off\"}))),!u&&1==this.currentStatus&&t.createElement(\"div\",{className:\"no-authority-box\"},\"无权限查看\"))}}]),g);function g(t){!function(t,e){if(!(t instanceof g))throw new TypeError(\"Cannot call a class as a function\")}(this);var e=function(t,e){if(!t)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!e||\"object\"!=typeof e&&\"function\"!=typeof e?t:e}(this,(g.__proto__||Object.getPrototypeOf(g)).call(this,t));return e.onClickSure=function(t){e.state.authoritySure?(e.setState({currentRiskWarn:t}),e.modal.show()):a.default.info(\"无权限操作\")},e.warnSure=function(){e.setState({modalOkBtnLoading:!0}),e.state.warningRemark?(0,m.post)({url:\"rmRiskWarn/update\",data:{id:e.state.currentRiskWarn.id,warningRemark:e.state.warningRemark},btn:function(){return e.setState({modalOkBtnLoading:!1})},success:function(t){a.default.success(\"风险告警确认成功\"),e.modal.hide(),e.getList()}}):(e.setState({modalOkBtnLoading:!1}),a.default.info(\"请输入告警备注\"))},e.getList=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=e.form?e.handleSearchParams(e.form.getFieldsValue()):{};t.params=Object.assign({},n,t.params);var a=e.state.table;a.setPage(t);var r=a.getParmaData();r.warningStatus=e.currentStatus,(0,m.post)({url:\"rmRiskWarn/queryRiskWarnHisByParam\",data:r,success:function(t){var n=t.pages;a.setPage({dataList:n.list,total:n.total,pageNum:n.pageNum,pageSize:n.pageSize}),e.setState({table:a})}})},e.submit=function(){event.preventDefault(),e.form.validateFields(function(t,n){t||(n=e.handleSearchParams(n),e.getList({params:n,pageNum:1}))})},e.reset=function(){e.form.resetFields(),e.submit()},e.state={tabs:[{name:\"风险告警列表\",status:0},{name:\"告警历史查询\",status:1}],table:new f.default,form:{fleetGrpList:[],branchInfoList:[],userBelongsToCompany:\"\"},warningRemark:null,currentRiskWarn:null,modalOkBtnLoading:!1,authorityList:(0,c.isAuthority)(\"flightRiskShow.warnList\",t.authority),authorityListHistory:(0,c.isAuthority)(\"flightRiskShow.warnListHistory\",t.authority),authoritySure:(0,c.isAuthority)(\"flightRiskShow.sureWarn\",t.authority)},e.currentStatu,e.columns,e.form,e.modal,e}e.default=(0,s.connect)(function(t){return{authority:t.authority}})((0,i.withRouter)(d))}).call(this,n(1))}}]);","extractedComments":[]}
{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{415:function(e,t,a){\"use strict\";(function(e){Object.defineProperty(t,\"__esModule\",{value:!0});var n=d(a(76)),l=d(a(25)),i=d(a(34)),o=function(e,t,a){return t&&s(e.prototype,t),a&&s(e,a),e};function s(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}a(75),a(24),a(33);var r=a(23),c=a(26),u=a(21),p=d(a(31));function d(e){return e&&e.__esModule?e:{default:e}}function f(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}function m(e,t){if(!e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!t||\"object\"!=typeof t&&\"function\"!=typeof t?e:t}function h(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function, not \"+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var y=i.default.confirm,g=(h(b,e.Component),o(b,[{key:\"componentDidMount\",value:function(){this.getAllFleet(),this.getFleetTailMap(),this.getAllBranch(),this.getSubPerformanceTypeMap(),this.getList()}},{key:\"componentWillUnmount\",value:function(){this.setState=function(e,t){}}},{key:\"getAllFleet\",value:function(){var e=this;(0,u.post)({url:\"acfData/queryAllFleet\",success:function(t){e.setState({allFleet:t.map(function(e){return{key:e.value,text:e.text}})})}})}},{key:\"getFleetTailMap\",value:function(){var e=this;(0,u.post)({url:\"acfData/queryFleetTailMap\",success:function(t){e.setState({fleetTailMap:t})}})}},{key:\"getAllBranch\",value:function(){var e=this;(0,u.post)({url:\"acfData/getAllBranch\",success:function(t){e.setState({allBranch:t})}})}},{key:\"getSubPerformanceTypeMap\",value:function(){var e=this;(0,u.post)({url:\"acfData/querySubPerformanceType\",success:function(t){e.setState({subPerformanceTypeMap:t})}})}},{key:\"getSearchFormValue\",value:function(){var e=this.searchForm.getFieldsValue();for(var t in e)\"tailFleetSelector\"==t&&delete e[t],\"branchCds\"!=t&&\"tailNrs\"!=t&&\"fleetCds\"!=t||!e[t]||(e[t]=e[t].value),\"tailNr\"==t&&(e.tailNrs=e[t],delete e[t]);return(0,c.handleInParams)(e)}},{key:\"getSearchFormOptions\",value:function(){var e=this,t=this.state,a=t.allFleet,n=t.fleetTailMap,l=t.allBranch.map(function(e){return{key:e.branchCd,text:e.branchCd}});return[{type:\"Radio\",name:\"tailFleetSelector\",list:[{text:\"按机尾号\",key:\"tail\"},{text:\"按机型\",key:\"fleet\"}],span:6,options:{initialValue:\"tail\"}},{type:\"Input\",label:\"机尾号\",name:\"tailNr\",span:6,placeholder:\"多个用逗号隔开\",hide:function(){return!(!e.searchForm||\"fleet\"!=e.searchForm.getFieldValue(\"tailFleetSelector\"))}},{type:\"MultipleSelect\",label:\"机型\",name:\"fleetCds\",list:a,span:6,isHasAllSelect:!1,onSelect:function(t){var a=[];t.forEach(function(e){a=a.concat(n[e].map(function(e){return{key:e,text:e}}))}),e.setState({fleetTailList:a})},hide:function(){return!(!e.searchForm||\"tail\"!=e.searchForm.getFieldValue(\"tailFleetSelector\"))}},{type:\"MultipleSelect\",label:\"机尾号\",name:\"tailNrs\",list:this.state.fleetTailList,span:6,hide:function(){return!(!e.searchForm||\"tail\"!=e.searchForm.getFieldValue(\"tailFleetSelector\"))}},{type:\"MultipleSelect\",label:\"所属公司\",name:\"branchCds\",list:l,span:6,className:\"clearBoth\"},{type:\"Input\",label:\"MSN\",name:\"msn\",span:6}]}},{key:\"getAddFormOptions\",value:function(){var e=this,t=this.state,a=t.fleetTailMap,n=t.subPerformanceTypeMap,l=t.allBranch,i=[];for(var o in a)i.push(o);var s=l.map(function(e){return{key:e.branchCd,text:e.branchCd}});return[{type:\"Input\",label:\"机尾号\",name:\"tailNr\",span:22,options:{rules:[{required:!0,message:\"机尾号不可为空！\"},{validator:function(e,t,a){t&&(\"B\"==t||\"B\"==t.trim()||\"\"==t.trim()||12<t.length)&&a(\"请输入正确的机尾号！\"),a()}}]}},{type:\"Select\",label:\"机型\",name:\"acftType\",span:22,list:i,isHasAllSelect:!1,onSelect:function(t){e.addForm.setFieldsValue({subPerformance:null});var a=n[t];e.setState({subPerformanceList:a})}},{type:\"Select\",label:\"性能子机型\",name:\"subPerformance\",span:22,list:this.state.subPerformanceList,isHasAllSelect:!1},{type:\"Input\",label:\"发动机\",name:\"engineType\",span:22,placeholder:\"长度不能超过50\",options:{rules:[{max:50,message:\"engineType的长度不能大于50\"}]}},{type:\"Input\",label:\"MSN\",name:\"msn\",span:22,placeholder:\"长度不能超过50\",options:{rules:[{max:50,message:\"msn的长度不能大于50\"}]}},{type:\"Select\",label:\"所属公司\",name:\"branchCd\",span:22,list:s,isHasAllSelect:!1}]}},{key:\"getFormOptions\",value:function(){var e=this.state.currentData,t=this.state,a=t.fleetTailMap,n=t.allBranch,l=[];for(var i in a)l.push(i);var o=n.map(function(e){return{key:e.branchCd,text:e.branchCd}}),s=[{type:\"Input\",label:\"机尾号\",name:\"tailNr\",span:4,length:3,disabled:!0,options:{initialValue:e.tailNr}},{type:\"Input\",label:\"发动机\",name:\"engineType\",span:4,length:3,placeholder:\"长度不能超过50\",options:{initialValue:e.engineType,rules:[{max:50,message:\"engineType的长度不能大于50\"}]}},{type:\"Select\",label:\"机型\",name:\"acftType\",span:4,length:2,list:l,isHasAllSelect:!1,options:{initialValue:e.acftType}},{type:\"Input\",label:\"性能子机型\",name:\"subPerformanceType\",span:4,length:5,disabled:!0,options:{initialValue:e.subPerformanceType}},{type:\"Input\",label:\"MSN\",name:\"msn\",span:4,length:3,placeholder:\"长度不能超过50\",options:{initialValue:e.msn,rules:[{max:50,message:\"msn的长度不能大于50\"}]}},{type:\"Select\",label:\"所属公司\",name:\"branchCd\",span:4,length:4,list:o,isHasAllSelect:!1,options:{initialValue:e.branchCd}}];return\"detail\"==this.state.currentAction&&(s=s.map(function(e){return e.disabled=!0,e})),s}},{key:\"render\",value:function(){var t=this,a=this.state,n=a.currentAction,l=a.table,i=a.modalOkBtnLoading,o=a.btns,s=a.currentData,c=a.selectedRowKeys,u=this.getSearchFormOptions(),p={aligin:\"left\",span:6,list:[{text:\"查询\",options:\"queryOpt\",event:this.search},{text:\"重置\",options:\"resetOpt\",event:this.reset}]},d={key:\"tailNr\",columns:this.columns,dataSource:l.dataList,rowSelection:{selectedRowKeys:c,onChange:function(e,a){t.onChecked(e,a)}}},f={pageNum:l.pageNum,pageSize:l.pageSize,total:l.total,onChange:this.getList},m={options:{title:\"新增飞机数据\",okButtonProps:{loading:i}},onRef:function(e){t.addModal=e},ok:this.addSubmit.bind(this)},h=this.getAddFormOptions(),y={options:{title:\"edit\"==n?\"编辑飞机详情\":\"查看飞机详情\",width:\"1000px\",okButtonProps:{loading:i}},onRef:function(e){t.modal=e},ok:this.submit.bind(this)};\"detail\"==n&&(y.options.footer=null);var g=this.getFormOptions();return e.createElement(r.CardCommon,null,e.createElement(r.CommonForm,{options:u,btnOptions:p,wrappedComponentRef:function(e){e&&e.props&&e.props.form&&(t.searchForm=e.props.form)}}),e.createElement(\"div\",{className:\"buttons\"},e.createElement(r.CommonBtns,{options:{shape:\"round\",size:\"small\"},btns:o})),e.createElement(r.CommonTable,{tableOptions:d,pagingOptions:f,onChecked:this.onChecked}),e.createElement(r.CommonModal,m,e.createElement(\"div\",{className:\"form-grid-6\"},e.createElement(r.CommonForm,{options:h,wrappedComponentRef:function(e){e&&e.props&&e.props.form&&(t.addForm=e.props.form)}}))),e.createElement(r.CommonModal,y,e.createElement(\"div\",null,e.createElement(r.CommonForm,{options:g,wrappedComponentRef:function(e){e&&e.props&&e.props.form&&(t.form=e.props.form)}}),e.createElement(v,{datas:s,currentAction:n,onRef:function(e){return t.tableCustom=e}}))))}}]),b);function b(t){f(this,b);var a=m(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,t));return a.getList=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};e.params=Object.assign({},a.getSearchFormValue(),e.params);var t=a.state.table;t.setPage(e);var n=t.getParmaData();(0,u.post)({url:\"acfData/queryAcfList\",data:n,success:function(e){if(e&&e.rows){var l=e.rows.map(function(e,t){return e.index=(n.pageNum-1)*n.pageSize+t+1,e});t.setPage({dataList:l,total:e.total,pageNum:n.pageNum,pageSize:n.pageSize}),a.setState({table:t,selectedRowKeys:[],selectedRows:[]})}}})},a.onChecked=function(e,t){a.setState({selectedRowKeys:e,selectedRows:t})},a.search=function(){a.searchForm.validateFields(function(e,t){e||a.getList()})},a.reset=function(){a.searchForm.resetFields(),a.getList({pageNum:1})},a.add=function(e){e(),a.addModal.show()},a.addSubmit=function(){a.setState({modalOkBtnLoading:!0}),a.addForm.validateFields(function(e,t){e?a.setState({modalOkBtnLoading:!1}):(t=(0,c.handleInParams)(t),(0,u.post)({url:\"acfData/addAcfBasic\",data:t,btn:function(){return a.setState({modalOkBtnLoading:!1})},success:function(e){l.default.success(\"添加用户成功！\"),a.addModal.hide(),a.getList({pageNum:1})}}))})},a.edit=function(e){0==a.state.selectedRows.length?(e(),l.default.warning(\"必须选择一个选项才能编辑！\")):1<a.state.selectedRows.length?(e(),l.default.warning(\"只能选择一个选项！\")):(e(),a.setState({currentAction:\"edit\",currentData:a.state.selectedRows[0]}),a.modal.show())},a.detail=function(e){a.setState({currentAction:\"detail\",currentData:e}),a.modal.show()},a.submit=function(){a.setState({modalOkBtnLoading:!0}),a.form.validateFields(function(e,t){e?a.setState({modalOkBtnLoading:!1}):((t=(0,c.handleInParams)(t)).aircraftsStr=JSON.stringify(a.tableCustom.state.dataSource),(0,u.post)({url:\"acfData/saveAcfDetail\",data:t,btn:function(){return a.setState({modalOkBtnLoading:!1})},success:function(e){l.default.success(\"修改成功\"),a.modal.hide(),a.getList({pageNum:1})}}))})},a.del=function(e){if(0==a.state.selectedRows.length)e(),l.default.warning(\"请至少选择一行数据\");else{var t=a.state.selectedRows.map(function(e){return e.tailNr});y({title:\"确认删除【\"+t.join(\"、\")+\"】吗?\",okType:\"danger\",onOk:function(){(0,u.post)({url:\"acfData/deleteAcf\",data:{tailNrs:t},btn:e,success:function(e){l.default.success(\"删除成功\"),a.getList({pageNum:1})}})},onCancel:e})}},a.state={allFleet:[],fleetTailMap:{},allBranch:[],subPerformanceTypeMap:{},subPerformanceList:[],fleetTailList:[],table:new p.default,selectedRowKeys:[],selectedRows:[],btns:[{name:\"新增\",icon:\"plus-circle\",onClick:a.add},{name:\"修改\",icon:\"edit\",onClick:a.edit},{name:\"删除\",icon:\"minus-circle\",onClick:a.del}],modalOkBtnLoading:!1,currentAction:\"\",currentData:{}},a.columns=[{title:\"编号\",dataIndex:\"index\"},{title:\"机型\",dataIndex:\"acftType\"},{title:\"性能子机型\",dataIndex:\"subPerformanceType\"},{title:\"机尾号\",dataIndex:\"tailNr\"},{title:\"发动机型号\",dataIndex:\"engineType\"},{title:\"MSN\",dataIndex:\"msn\"},{title:\"所属公司\",dataIndex:\"branchCd\"},{title:\"更新人\",dataIndex:\"operUser\"},{title:\"更新时间\",dataIndex:\"updateTime\"},{title:\"操作\",key:\"action\",render:function(t){return e.createElement(\"a\",{onClick:function(){return a.detail(t)}},\"查看\")}}],a.searchForm,a.addModal,a.addForm,a.modal,a.form,a.tableCustom,a}var v=(h(S,e.Component),o(S,[{key:\"componentDidMount\",value:function(){this.props.onRef&&this.props.onRef(this),this.getTypes(),this.getDepts(),this.getSubDepts(),this.getDeptMap(),this.getList()}},{key:\"componentWillUnmount\",value:function(){this.setState=function(e,t){}}},{key:\"getColumns\",value:function(){var e=this;return[{title:\"编号\",dataIndex:\"index\",width:50},{title:\"类别\",dataIndex:\"colType\",width:100},{title:\"数据项目\",dataIndex:\"colChnName\",width:200},{title:\"具体数据信息\",dataIndex:\"colValue\",width:100,render:function(t,a){return e.getDom(\"colValue\",t,a)}},{title:\"数据说明\",dataIndex:\"sourceCd\",width:100},{title:\"备注\",dataIndex:\"remark\",width:100,render:function(t,a){return e.getDom(\"remark\",t,a)}},{title:\"维护部门\",dataIndex:\"deptName\",width:100}]}},{key:\"getDom\",value:function(t,a,l){var i=this;return\"detail\"==this.props.currentAction?e.createElement(\"div\",null,a):this.state.edit&&l.aircraftColsId==this.state.selected.aircraftColsId&&t==this.state.selectedKey?e.createElement(n.default,{defaultValue:a,onBlur:function(e){return i.editTable(t,l,!1,e)},autoComplete:\"off\"}):e.createElement(\"div\",{style:{minHeight:\"22px\"},onClick:this.editTable.bind(this,t,l,!0)},a)}},{key:\"editTable\",value:function(e,t,a,n){if(this.setState({edit:a,selected:t,selectedKey:e}),!a){var l=this.state.dataSource.map(function(a){return a.aircraftColsId==t.aircraftColsId&&(a[e]=n.target.value),a});this.setState({dataSource:l})}}},{key:\"getTypes\",value:function(){var e=this;(0,u.post)({url:\"acfData/queryAllDataTypes\",success:function(t){e.setState({types:t.map(function(e){return{key:e.value,text:e.text}})})}})}},{key:\"getDepts\",value:function(){var e=this;(0,u.post)({url:\"acfData/queryAllDepts\",success:function(t){e.setState({depts:t.map(function(e){return{key:e.value,text:e.text}})})}})}},{key:\"getSubDepts\",value:function(){var e=this;(0,u.post)({url:\"acfData/queryAllSubDepts\",success:function(t){e.setState({subDepts:t.map(function(e){return{key:e.value,text:e.text}})})}})}},{key:\"getDeptMap\",value:function(){var e=this;(0,u.post)({url:\"acfData/queryDeptMap\",success:function(t){e.setState({deptMap:t})}})}},{key:\"getSearchFormOptions\",value:function(){var e=this,t=this.state,a=t.types,n=t.depts,l=t.subDepts;return[{type:\"Radio\",name:\"deptTypeSelector\",list:[{text:\"按部门筛选\",key:\"dept\"},{text:\"按类别筛选\",key:\"info-type\"}],span:7,options:{initialValue:\"info-type\"}},{type:\"MultipleSelect\",label:\"一级部门\",name:\"dept1\",list:n,span:6,length:4,onSelect:this.searchDeptChange,onDeselect:this.searchDeptChange,hide:function(){return!(!e.searchForm||\"info-type\"!=e.searchForm.getFieldValue(\"deptTypeSelector\"))},options:{initialValue:n.map(function(e){return e.key})}},{type:\"MultipleSelect\",label:\"二级部门\",name:\"dept\",list:l,span:6,length:4,hide:function(){return!(!e.searchForm||\"info-type\"!=e.searchForm.getFieldValue(\"deptTypeSelector\"))},options:{initialValue:l.map(function(e){return e.key})}},{type:\"MultipleSelect\",label:\"数据类别\",name:\"dataType\",list:a,span:6,length:4,hide:function(){return!(!e.searchForm||\"dept\"!=e.searchForm.getFieldValue(\"deptTypeSelector\"))}}]}},{key:\"render\",value:function(){var t=this,a=this.getSearchFormOptions(),n={aligin:\"left\",span:5,list:[{text:\"查询\",options:\"queryOpt\",event:this.search}]},l={notCheck:!0,columns:this.getColumns(),dataSource:this.state.dataSource,scroll:{x:\"750px\",y:\"300px\"}};return e.createElement(e.Fragment,null,e.createElement(r.CommonForm,{options:a,btnOptions:n,wrappedComponentRef:function(e){e&&e.props&&e.props.form&&(t.searchForm=e.props.form)}}),e.createElement(r.CommonTable,{tableOptions:l,needPage:!1}))}}]),S);function S(e){f(this,S);var t=m(this,(S.__proto__||Object.getPrototypeOf(S)).call(this,e));return t.getList=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};e.tailNr=t.props.datas.tailNr,(0,u.post)({url:\"acfData/queryAcfDetail\",data:e,success:function(e){if(e&&e.rows){var a=e.rows.map(function(e,t){return e.index=t+1,e});t.setState({dataSource:a})}}})},t.search=function(){t.searchForm.validateFields(function(e,a){if(!e){var n={};for(var i in a)a[i]&&(\"dataType\"!=i&&\"dept1\"!=i&&\"dept\"!=i||(n[i]=a[i].value));if(\"dept\"==a.deptTypeSelector&&0==n.dept1.length)return void l.default.warning(\"请选择一级部门！\");if(\"dept\"==a.deptTypeSelector&&0==n.dept.length)return void l.default.warning(\"请选择二级部门！\");n.dept&&-1<n.dept.indexOf(\"全部\")&&(n.dept1&&-1<n.dept1.indexOf(\"全部\")?n={}:n.dept=n.dept1),n.dept1&&delete n.dept1,t.getList(n)}})},t.searchDeptChange=function(e){var a=t.state.deptMap,n=[];e.forEach(function(e){a[e]&&(n=n.concat(a[e].map(function(e){return{key:e,text:e}})))}),t.setState({subDepts:n})},t.state={dataSource:[],types:[],depts:[],subDepts:[],deptMap:{},edit:!1,selected:{},selectedKey:\"\"},t.searchForm,t}t.default=g}).call(this,a(1))}}]);","extractedComments":[]}
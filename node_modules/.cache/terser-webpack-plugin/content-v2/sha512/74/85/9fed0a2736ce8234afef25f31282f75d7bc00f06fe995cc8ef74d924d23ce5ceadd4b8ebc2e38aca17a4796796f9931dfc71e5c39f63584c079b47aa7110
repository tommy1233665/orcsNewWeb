{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{442:function(e,t,a){\"use strict\";(function(e){Object.defineProperty(t,\"__esModule\",{value:!0});var n=p(a(28)),i=p(a(34));function o(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}a(27),a(33);var l=a(20),r=a(24),s=a(25),u=a(22),c=a(21),d=p(a(31));function p(e){return e&&e.__esModule?e:{default:e}}var f=i.default.confirm,m=\"weather.add\",y=\"weather.edit\",h=\"weather.del\",b=(function(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function, not \"+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(k,e.Component),function(e,t,a){t&&o(e.prototype,t),a&&o(e,a)}(k,[{key:\"componentDidMount\",value:function(){this.getList()}},{key:\"componentWillUnmount\",value:function(){this.setState=function(e,t){}}},{key:\"cloudData\",value:function(e,t){return\"lt\"==t.cloudMark?\"<\"+e:\"le\"==t.cloudMark?\"<=\"+e:\"gt\"==t.cloudMark?\">\"+e:\"ge\"==t.cloudMark?\">=\"+e:\"equal\"==t.cloudMark?\"=\"+e:e}},{key:\"visibilityMark\",value:function(e,t){return\"lt\"==t.visibilityMark?\"<\"+t.visibilityValue:\"le\"==t.visibilityMark?\"<=\"+t.visibilityValue:\"gt\"==t.visibilityMark?\">\"+t.visibilityValue:\"ge\"==t.visibilityMark?\">=\"+t.visibilityValue:\"equal\"==t.visibilityMark?\"=\"+t.visibilityValue:t.visibilityValue}},{key:\"getFormOptions\",value:function(){var e=this.state,t=e.currentAction,a=e.currentData,n=\"add\"==t?{}:a,i=[{key:\"lt\",text:\"<\"},{key:\"le\",text:\"<=\"},{key:\"gt\",text:\">\"},{key:\"ge\",text:\">=\"},{key:\"equal\",text:\"=\"}],o=/^0$|^-?[1-9]\\d*$|^-?[1-9]\\d*.\\d{1,2}$|^-?0.\\d{1,2}$/,l=\"请输入数字，最多保留两位小数；如：0、-5、5.1、-5.11\",r=\"请输入数字，最多保留两位小数\";return[{type:\"Select\",label:\"分类\",name:\"weatherType\",list:[{key:\"B\",text:\"边缘天气\"},{key:\"U\",text:\"非边缘天气\"}],span:24,isHasAllSelect:!1,options:{initialValue:n.weatherType}},{type:\"Select\",label:\"进近类型\",name:\"approachType\",list:[{key:\"A\",text:\"精密进近\"},{key:\"U\",text:\"非精密进近\"}],span:24,isHasAllSelect:!1,options:{initialValue:n.approachType}},{type:\"Select\",label:\"云高标准差值运算符\",name:\"cloudMark\",list:i,span:24,isHasAllSelect:!1,options:{initialValue:n.cloudMark}},{type:\"Input\",label:\"云高标准差值\",name:\"cloudData\",span:24,placeholder:r,options:{initialValue:n.cloudData,rules:[{pattern:o,message:l}]}},{type:\"Select\",label:\"能见度标准差值运算符\",name:\"visibilityMark\",list:i,span:24,isHasAllSelect:!1,options:{initialValue:n.visibilityMark}},{type:\"Input\",label:\"能见度标准差值\",name:\"visibilityValue\",span:24,placeholder:r,options:{initialValue:n.visibilityValue,rules:[{pattern:o,message:l}]}}]}},{key:\"render\",value:function(){var t=this,a=this.state,n=a.table,i=a.modalOkBtnLoading,o=a.currentAction,l=a.selectedRowKeys,r=a.authorityList,u={table:n,onChange:this.getList,columns:this.columns,rowSelection:{selectedRowKeys:l,onChange:function(e,a){t.onChecked(e,a)}}},c={options:{title:\"add\"==o?\"新增\":\"edit\"==o?\"修改\":\"\",okButtonProps:{loading:i}},onRef:function(e){t.modal=e},ok:this.submit.bind(this)},d=this.getFormOptions();return e.createElement(s.CardCommon,null,e.createElement(\"div\",{className:\"buttons\"},e.createElement(s.CommonBtns,{options:{shape:\"round\",size:\"small\"},btns:this.state.btns})),r&&e.createElement(s.CommonTable,{options:u,onChecked:this.onChecked}),!r&&e.createElement(\"div\",{className:\"no-authority-box\"},\"无权限查看\"),e.createElement(s.CommonModal,c,e.createElement(\"div\",{className:\"mb30\"},\"气象标准信息:\"),e.createElement(\"div\",{className:\"form-grid-10\",style:{paddingLeft:\"30px\",paddingRight:\"60px\"}},e.createElement(s.CommonForm,{options:d,wrappedComponentRef:function(e){e&&e.props&&e.props.form&&(t.form=e.props.form)}}))))}}]),k);function k(e){!function(e,t){if(!(e instanceof k))throw new TypeError(\"Cannot call a class as a function\")}(this);var t=function(e,t){if(!e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!t||\"object\"!=typeof t&&\"function\"!=typeof t?e:t}(this,(k.__proto__||Object.getPrototypeOf(k)).call(this,e));return t.getList=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},a=t.state.table;a.setPage(e);var n=a.getParmaData();(0,c.post)({url:\"weather/queryweatherListAll\",data:n,success:function(e){if(e&&e.rows){var i=e.rows.map(function(e,t){return e.index=(n.pageNum-1)*n.pageSize+t+1,e});a.setPage({dataList:i,total:e.total,pageNum:n.pageNum,pageSize:n.pageSize}),t.setState({table:a,selectedRowKeys:[],selectedRows:[]})}}})},t.onChecked=function(e,a){t.setState({selectedRowKeys:e,selectedRows:a})},t.add=function(e){e(),t.setState({currentAction:\"add\"}),t.modal.show()},t.edit=function(e){0==t.state.selectedRows.length?(e(),n.default.warning(\"必须选择一个选项才能编辑！\")):1<t.state.selectedRows.length?(e(),n.default.warning(\"只能选择一个选项！\")):(e(),t.setState({currentAction:\"edit\",currentData:t.state.selectedRows[0]}),t.modal.show())},t.submit=function(){t.setState({modalOkBtnLoading:!0}),t.form.validateFields(function(e,a){var i,o;e?t.setState({modalOkBtnLoading:!1}):(a=(0,u.handleInParams)(a),o=\"add\"==t.state.currentAction?(i=\"weather/insert\",\"添加成功\"):(a.id=t.state.currentData.id,i=\"weather/update\",\"修改成功\"),(0,c.post)({url:i,data:a,btn:function(){return t.setState({modalOkBtnLoading:!1})},success:function(e){n.default.success(o),t.modal.hide(),t.getList({pageNum:1})}}))})},t.del=function(e){if(0==t.state.selectedRows.length)e(),n.default.warning(\"请至少选择一行数据\");else{var a=t.state.selectedRows.map(function(e){return e.id});f({title:\"确认删除选中项吗?\",okType:\"danger\",onOk:function(){(0,c.post)({url:\"weather/delete\",data:{ids:a},btn:e,success:function(e){n.default.success(\"删除成功\"),t.getList({pageNum:1})}})},onCancel:e})}},t.state={table:new d.default,selectedRowKeys:[],selectedRows:[],btns:[{name:\"新增\",id:m,icon:\"plus-circle\",onClick:t.add},{name:\"修改\",id:y,icon:\"edit\",onClick:t.edit},{name:\"删除\",id:h,icon:\"minus-circle\",onClick:t.del}].filter(function(t){return(0,u.isAuthority)(t.id,e.authority)}),modalOkBtnLoading:!1,currentAction:\"\",currentData:{},authorityList:(0,u.isAuthority)(\"weather.list\",e.authority)},t.columns=[{title:\"序号\",dataIndex:\"index\"},{title:\"分类\",dataIndex:\"weatherType\",render:function(e){return\"B\"==e?\"边缘天气\":\"U\"==e?\"非边缘天气\":\"\"}},{title:\"进近类型\",dataIndex:\"approachType\",render:function(e){return\"A\"==e?\"精密进近\":\"U\"==e?\"非精密进近\":\"\"}},{title:\"云高标准差值\",dataIndex:\"cloudData\",render:function(e,a){return t.cloudData(e,a)}},{title:\"能见度标准差值\",dataIndex:\"visibilityMark\",render:function(e,a){return t.visibilityMark(e,a)}}],t.modal,t.form,t}t.default=(0,r.connect)(function(e){return{authority:e.authority}})((0,l.withRouter)(b))}).call(this,a(1))}}]);","extractedComments":[]}
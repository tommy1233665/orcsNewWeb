{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{418:function(e,t,a){\"use strict\";(function(e){Object.defineProperty(t,\"__esModule\",{value:!0});var n=m(a(77)),i=m(a(28)),l=m(a(36)),o=function(e,t,a){return t&&s(e.prototype,t),a&&s(e,a),e};function s(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}a(76),a(27),a(35);var r=a(20),c=a(24),u=a(25),p=a(23),d=a(22),f=m(a(32));function m(e){return e&&e.__esModule?e:{default:e}}function h(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}function y(e,t){if(!e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!t||\"object\"!=typeof t&&\"function\"!=typeof t?e:t}function g(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function, not \"+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var b=l.default.confirm,v=\"acfData.add\",S=\"acfData.edit\",k=\"acfData.del\",F=(g(C,e.Component),o(C,[{key:\"componentDidMount\",value:function(){this.getAllFleet(),this.getFleetTailMap(),this.getAllBranch(),this.getSubPerformanceTypeMap(),this.getList()}},{key:\"componentWillUnmount\",value:function(){this.setState=function(e,t){}}},{key:\"getAllFleet\",value:function(){var e=this;(0,d.post)({url:\"acfData/queryAllFleet\",success:function(t){e.setState({allFleet:t.map(function(e){return{key:e.value,text:e.text}})})}})}},{key:\"getFleetTailMap\",value:function(){var e=this;(0,d.post)({url:\"acfData/queryFleetTailMap\",success:function(t){e.setState({fleetTailMap:t})}})}},{key:\"getAllBranch\",value:function(){var e=this;(0,d.post)({url:\"acfData/getAllBranch\",success:function(t){e.setState({allBranch:t})}})}},{key:\"getSubPerformanceTypeMap\",value:function(){var e=this;(0,d.post)({url:\"acfData/querySubPerformanceType\",success:function(t){e.setState({subPerformanceTypeMap:t})}})}},{key:\"getSearchFormValue\",value:function(e){for(var t in e)\"tailFleetSelector\"==t&&delete e[t],\"branchCds\"!=t&&\"tailNrs\"!=t&&\"fleetCds\"!=t||!e[t]||(e[t]=e[t].value?e[t].value:e[t]),\"tailNr\"==t&&(e.tailNrs=e[t],delete e[t]);return(0,p.handleInParams)(e)}},{key:\"getSearchFormOptions\",value:function(){var e=this,t=this.state,a=t.allFleet,n=t.fleetTailMap,i=t.allBranch.map(function(e){return{key:e.branchCd,text:e.branchCd}});return[{type:\"Radio\",name:\"tailFleetSelector\",list:[{text:\"按机尾号\",key:\"tail\"},{text:\"按机型\",key:\"fleet\"}],span:6,options:{initialValue:\"tail\"}},{type:\"Input\",label:\"机尾号\",name:\"tailNr\",span:6,placeholder:\"多个用逗号隔开\",hide:function(){return!(!e.searchForm||\"fleet\"!=e.searchForm.getFieldValue(\"tailFleetSelector\"))}},{type:\"MultipleSelect\",label:\"机型\",name:\"fleetCds\",list:a,span:6,isHasAllSelect:!1,onSelect:function(t){var a=[];t.forEach(function(e){a=a.concat(n[e].map(function(e){return{key:e,text:e}}))}),e.setState({fleetTailList:a})},hide:function(){return!(!e.searchForm||\"tail\"!=e.searchForm.getFieldValue(\"tailFleetSelector\"))}},{type:\"MultipleSelect\",label:\"机尾号\",name:\"tailNrs\",list:this.state.fleetTailList,span:6,hide:function(){return!(!e.searchForm||\"tail\"!=e.searchForm.getFieldValue(\"tailFleetSelector\"))}},{type:\"MultipleSelect\",label:\"所属公司\",name:\"branchCds\",list:i,span:6,className:\"clearBoth\"},{type:\"Input\",label:\"MSN\",name:\"msn\",span:6}]}},{key:\"getAddFormOptions\",value:function(){var e=this,t=this.state,a=t.fleetTailMap,n=t.subPerformanceTypeMap,i=t.allBranch,l=[];for(var o in a)l.push(o);var s=i.map(function(e){return{key:e.branchCd,text:e.branchCd}});return[{type:\"Input\",label:\"机尾号\",name:\"tailNr\",span:22,options:{rules:[{required:!0,message:\"机尾号不可为空！\"},{validator:function(e,t,a){t&&(\"B\"==t||\"B\"==t.trim()||\"\"==t.trim()||12<t.length)&&a(\"请输入正确的机尾号！\"),a()}}]}},{type:\"Select\",label:\"机型\",name:\"acftType\",span:22,list:l,isHasAllSelect:!1,onSelect:function(t){e.addForm.setFieldsValue({subPerformance:null});var a=n[t];e.setState({subPerformanceList:a})}},{type:\"Select\",label:\"性能子机型\",name:\"subPerformance\",span:22,list:this.state.subPerformanceList,isHasAllSelect:!1},{type:\"Input\",label:\"发动机\",name:\"engineType\",span:22,placeholder:\"长度不能超过50\",options:{rules:[{max:50,message:\"engineType的长度不能大于50\"}]}},{type:\"Input\",label:\"MSN\",name:\"msn\",span:22,placeholder:\"长度不能超过50\",options:{rules:[{max:50,message:\"msn的长度不能大于50\"}]}},{type:\"Select\",label:\"所属公司\",name:\"branchCd\",span:22,list:s,isHasAllSelect:!1}]}},{key:\"getFormOptions\",value:function(){var e=this.state.currentData,t=this.state,a=t.fleetTailMap,n=t.allBranch,i=[];for(var l in a)i.push(l);var o=n.map(function(e){return{key:e.branchCd,text:e.branchCd}}),s=[{type:\"Input\",label:\"机尾号\",name:\"tailNr\",span:4,length:3,disabled:!0,options:{initialValue:e.tailNr}},{type:\"Input\",label:\"发动机\",name:\"engineType\",span:4,length:3,placeholder:\"长度不能超过50\",tooltip:\"长度不能超过50\",options:{initialValue:e.engineType,rules:[{max:50,message:\"engineType的长度不能大于50\"}]}},{type:\"Select\",label:\"机型\",name:\"acftType\",span:4,length:2,list:i,isHasAllSelect:!1,options:{initialValue:e.acftType}},{type:\"Input\",label:\"性能子机型\",name:\"subPerformanceType\",span:4,length:5,disabled:!0,tooltip:e.subPerformanceType,options:{initialValue:e.subPerformanceType}},{type:\"Input\",label:\"MSN\",name:\"msn\",span:4,length:3,placeholder:\"长度不能超过50\",options:{initialValue:e.msn,rules:[{max:50,message:\"msn的长度不能大于50\"}]}},{type:\"Select\",label:\"所属公司\",name:\"branchCd\",span:4,length:4,list:o,isHasAllSelect:!1,options:{initialValue:e.branchCd}}];return\"detail\"==this.state.currentAction&&(s=s.map(function(e){return e.disabled=!0,e})),s}},{key:\"render\",value:function(){var t=this,a=this.state,n=a.currentAction,i=a.table,l=a.modalOkBtnLoading,o=a.btns,s=a.currentData,r=a.selectedRowKeys,c=a.authorityList,p=this.getSearchFormOptions(),d={aligin:\"left\",span:6,list:[{text:\"查询\",options:\"queryOpt\",event:this.search},{text:\"重置\",options:\"resetOpt\",event:this.reset}]},f={key:\"tailNr\",columns:this.columns,table:i,rowSelection:{selectedRowKeys:r,onChange:function(e,a){t.onChecked(e,a)}},onChange:this.getList},m={options:{title:\"新增飞机数据\",okButtonProps:{loading:l}},onRef:function(e){t.addModal=e},ok:this.addSubmit.bind(this)},h=this.getAddFormOptions(),y={options:{title:\"edit\"==n?\"编辑飞机详情\":\"查看飞机详情\",width:\"1000px\",okButtonProps:{loading:l}},onRef:function(e){t.modal=e},ok:this.submit.bind(this)};\"detail\"==n&&(y.options.footer=null);var g=this.getFormOptions();return e.createElement(u.CardCommon,null,c&&e.createElement(u.CommonForm,{options:p,btnOptions:d,wrappedComponentRef:function(e){e&&e.props&&e.props.form&&(t.searchForm=e.props.form)}}),e.createElement(\"div\",{className:\"buttons\"},e.createElement(u.CommonBtns,{options:{shape:\"round\",size:\"small\"},btns:o})),c&&e.createElement(u.CommonTable,{options:f,onChecked:this.onChecked}),!c&&e.createElement(\"div\",{className:\"no-authority-box\"},\"无权限查看\"),e.createElement(u.CommonModal,m,e.createElement(\"div\",{className:\"form-grid-6\"},e.createElement(u.CommonForm,{options:h,wrappedComponentRef:function(e){e&&e.props&&e.props.form&&(t.addForm=e.props.form)}}))),e.createElement(u.CommonModal,y,e.createElement(\"div\",null,e.createElement(u.CommonForm,{options:g,wrappedComponentRef:function(e){e&&e.props&&e.props.form&&(t.form=e.props.form)}}),e.createElement(w,{datas:s,currentAction:n,onRef:function(e){return t.tableCustom=e}}))))}}]),C);function C(t){h(this,C);var a=y(this,(C.__proto__||Object.getPrototypeOf(C)).call(this,t));return a.getList=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=a.state.table;t.setPage(e);var n=t.getParmaData();(0,d.post)({url:\"acfData/queryAcfList\",data:n,success:function(e){if(e&&e.rows){var i=e.rows.map(function(e,t){return e.index=(n.pageNum-1)*n.pageSize+t+1,e});t.setPage({dataList:i,total:e.total,pageNum:n.pageNum,pageSize:n.pageSize}),a.setState({table:t,selectedRowKeys:[],selectedRows:[]})}}})},a.onChecked=function(e,t){a.setState({selectedRowKeys:e,selectedRows:t})},a.search=function(){a.searchForm.validateFields(function(e,t){e||(t=a.getSearchFormValue(t),a.getList({params:t,pageNum:1}))})},a.reset=function(){a.searchForm.resetFields(),a.search()},a.add=function(e){e(),a.addModal.show()},a.addSubmit=function(){a.setState({modalOkBtnLoading:!0}),a.addForm.validateFields(function(e,t){e?a.setState({modalOkBtnLoading:!1}):(t=(0,p.handleInParams)(t),(0,d.post)({url:\"acfData/addAcfBasic\",data:t,btn:function(){return a.setState({modalOkBtnLoading:!1})},success:function(e){i.default.success(\"添加用户成功！\"),a.addModal.hide(),a.getList({pageNum:1})}}))})},a.edit=function(e){0==a.state.selectedRows.length?(e(),i.default.warning(\"必须选择一个选项才能编辑！\")):1<a.state.selectedRows.length?(e(),i.default.warning(\"只能选择一个选项！\")):(e(),a.setState({currentAction:\"edit\",currentData:a.state.selectedRows[0]}),a.modal.show())},a.detail=function(e){a.state.authorityDetail?(a.setState({currentAction:\"detail\",currentData:e}),a.modal.show()):i.default.info(\"无权限查看\")},a.submit=function(){a.setState({modalOkBtnLoading:!0}),a.form.validateFields(function(e,t){e?a.setState({modalOkBtnLoading:!1}):((t=(0,p.handleInParams)(t)).aircraftsStr=JSON.stringify(a.tableCustom.state.dataSource),(0,d.post)({url:\"acfData/saveAcfDetail\",data:t,btn:function(){return a.setState({modalOkBtnLoading:!1})},success:function(e){i.default.success(\"修改成功\"),a.modal.hide(),a.getList({pageNum:1})}}))})},a.del=function(e){if(0==a.state.selectedRows.length)e(),i.default.warning(\"请至少选择一行数据\");else{var t=a.state.selectedRows.map(function(e){return e.tailNr});b({title:\"确认删除【\"+t.join(\"、\")+\"】吗?\",okType:\"danger\",onOk:function(){(0,d.post)({url:\"acfData/deleteAcf\",data:{tailNrs:t},btn:e,success:function(e){i.default.success(\"删除成功\"),a.getList({pageNum:1})}})},onCancel:e})}},a.state={allFleet:[],fleetTailMap:{},allBranch:[],subPerformanceTypeMap:{},subPerformanceList:[],fleetTailList:[],table:new f.default,selectedRowKeys:[],selectedRows:[],btns:[{name:\"新增\",id:v,icon:\"plus-circle\",onClick:a.add},{name:\"修改\",id:S,icon:\"edit\",onClick:a.edit},{name:\"删除\",id:k,icon:\"minus-circle\",onClick:a.del}].filter(function(e){return(0,p.isAuthority)(e.id,t.authority)}),modalOkBtnLoading:!1,currentAction:\"\",currentData:{},authorityList:(0,p.isAuthority)(\"acfData.list\",t.authority),authorityDetail:(0,p.isAuthority)(\"acfData.detail\",t.authority)},a.columns=[{title:\"编号\",dataIndex:\"index\"},{title:\"机型\",dataIndex:\"acftType\"},{title:\"性能子机型\",dataIndex:\"subPerformanceType\"},{title:\"机尾号\",dataIndex:\"tailNr\"},{title:\"发动机型号\",dataIndex:\"engineType\"},{title:\"MSN\",dataIndex:\"msn\"},{title:\"所属公司\",dataIndex:\"branchCd\"},{title:\"更新人\",dataIndex:\"operUser\"},{title:\"更新时间\",dataIndex:\"updateTime\"},{title:\"操作\",key:\"action\",render:function(t){return e.createElement(\"a\",{onClick:function(){return a.detail(t)}},\"查看\")}}],a.searchForm,a.addModal,a.addForm,a.modal,a.form,a.tableCustom,a}var w=(g(x,e.Component),o(x,[{key:\"componentDidMount\",value:function(){this.props.onRef&&this.props.onRef(this),this.getTypes(),this.getDepts(),this.getSubDepts(),this.getDeptMap(),this.getList()}},{key:\"componentWillUnmount\",value:function(){this.setState=function(e,t){}}},{key:\"getColumns\",value:function(){var e=this;return[{title:\"编号\",dataIndex:\"index\",width:50},{title:\"类别\",dataIndex:\"colType\",width:100},{title:\"数据项目\",dataIndex:\"colChnName\",width:200},{title:\"具体数据信息\",dataIndex:\"colValue\",width:100,render:function(t,a){return e.getDom(\"colValue\",t,a)}},{title:\"数据说明\",dataIndex:\"sourceCd\",width:100},{title:\"备注\",dataIndex:\"remark\",width:100,render:function(t,a){return e.getDom(\"remark\",t,a)}},{title:\"维护部门\",dataIndex:\"deptName\",width:100}]}},{key:\"getDom\",value:function(t,a,i){var l=this;return\"detail\"==this.props.currentAction?e.createElement(\"div\",null,a):this.state.edit&&i.aircraftColsId==this.state.selected.aircraftColsId&&t==this.state.selectedKey?e.createElement(n.default,{defaultValue:a,onBlur:function(e){return l.editTable(t,i,!1,e)},autoComplete:\"off\"}):e.createElement(\"div\",{style:{minHeight:\"22px\"},onClick:this.editTable.bind(this,t,i,!0)},a)}},{key:\"editTable\",value:function(e,t,a,n){if(this.setState({edit:a,selected:t,selectedKey:e}),!a){var i=this.state.dataSource.map(function(a){return a.aircraftColsId==t.aircraftColsId&&(a[e]=n.target.value),a});this.setState({dataSource:i})}}},{key:\"getTypes\",value:function(){var e=this;(0,d.post)({url:\"acfData/queryAllDataTypes\",success:function(t){e.setState({types:t.map(function(e){return{key:e.value,text:e.text}})})}})}},{key:\"getDepts\",value:function(){var e=this;(0,d.post)({url:\"acfData/queryAllDepts\",success:function(t){e.setState({depts:t.map(function(e){return{key:e.value,text:e.text}})})}})}},{key:\"getSubDepts\",value:function(){var e=this;(0,d.post)({url:\"acfData/queryAllSubDepts\",success:function(t){e.setState({subDepts:t.map(function(e){return{key:e.value,text:e.text}})})}})}},{key:\"getDeptMap\",value:function(){var e=this;(0,d.post)({url:\"acfData/queryDeptMap\",success:function(t){e.setState({deptMap:t})}})}},{key:\"getSearchFormOptions\",value:function(){var e=this,t=this.state,a=t.types,n=t.depts,i=t.subDepts;return[{type:\"Radio\",name:\"deptTypeSelector\",list:[{text:\"按部门筛选\",key:\"dept\"},{text:\"按类别筛选\",key:\"info-type\"}],span:7,options:{initialValue:\"info-type\"}},{type:\"MultipleSelect\",label:\"一级部门\",name:\"dept1\",list:n,span:6,length:4,onSelect:this.searchDeptChange,onDeselect:this.searchDeptChange,hide:function(){return!(!e.searchForm||\"info-type\"!=e.searchForm.getFieldValue(\"deptTypeSelector\"))},options:{initialValue:n.map(function(e){return e.key})}},{type:\"MultipleSelect\",label:\"二级部门\",name:\"dept\",list:i,span:6,length:4,hide:function(){return!(!e.searchForm||\"info-type\"!=e.searchForm.getFieldValue(\"deptTypeSelector\"))},options:{initialValue:i.map(function(e){return e.key})}},{type:\"MultipleSelect\",label:\"数据类别\",name:\"dataType\",list:a,span:6,length:4,hide:function(){return!(!e.searchForm||\"dept\"!=e.searchForm.getFieldValue(\"deptTypeSelector\"))}}]}},{key:\"render\",value:function(){var t=this,a=this.getSearchFormOptions(),n={aligin:\"left\",span:5,list:[{text:\"查询\",options:\"queryOpt\",event:this.search}]},i={notCheck:!0,columns:this.getColumns(),table:{dataList:this.state.dataSource,loading:this.state.loading},scroll:{x:\"750px\",y:\"300px\"},needPage:!1};return e.createElement(e.Fragment,null,e.createElement(u.CommonForm,{options:a,btnOptions:n,wrappedComponentRef:function(e){e&&e.props&&e.props.form&&(t.searchForm=e.props.form)}}),e.createElement(u.CommonTable,{options:i}))}}]),x);function x(e){h(this,x);var t=y(this,(x.__proto__||Object.getPrototypeOf(x)).call(this,e));return t.getList=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};e.tailNr=t.props.datas.tailNr,(0,d.post)({url:\"acfData/queryAcfDetail\",data:e,success:function(e){if(e&&e.rows){var a=e.rows.map(function(e,t){return e.index=t+1,e});t.setState({dataSource:a,loading:!1})}}})},t.search=function(){t.searchForm.validateFields(function(e,a){if(!e){var n={};for(var l in a)a[l]&&(\"dataType\"!=l&&\"dept1\"!=l&&\"dept\"!=l||(n[l]=a[l].value?a[l].value:a[l]));if(\"dept\"==a.deptTypeSelector&&(!n.dept1||n.dept1&&0==n.dept1.length))return void i.default.warning(\"请选择一级部门！\");if(\"dept\"==a.deptTypeSelector&&(!n.dept||n.dept&&0==n.dept.length))return void i.default.warning(\"请选择二级部门！\");n.dept&&-1<n.dept.indexOf(\"全部\")&&(n.dept1&&-1<n.dept1.indexOf(\"全部\")?n={}:n.dept=n.dept1),n.dept1&&delete n.dept1,t.getList(n)}})},t.searchDeptChange=function(e){var a=t.state.deptMap,n=[];e.forEach(function(e){a[e]&&(n=n.concat(a[e].map(function(e){return{key:e,text:e}})))}),t.setState({subDepts:n})},t.state={dataSource:[],types:[],depts:[],subDepts:[],deptMap:{},edit:!1,selected:{},selectedKey:\"\",loading:!0},t.searchForm,t}t.default=(0,c.connect)(function(e){return{authority:e.authority}})((0,r.withRouter)(F))}).call(this,a(1))}}]);","extractedComments":[]}
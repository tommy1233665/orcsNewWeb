{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{427:function(t,e,n){\"use strict\";(function(t){Object.defineProperty(e,\"__esModule\",{value:!0});var a=p(n(27)),o=p(n(35));function i(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,\"value\"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}n(26),n(34);var s=n(20),r=n(24),l=n(25),c=n(22),u=n(21),d=p(n(29));function p(t){return t&&t.__esModule?t:{default:t}}var m=o.default.confirm,f=\"ndTailData.add\",h=\"ndTailData.edit\",g=\"ndTailData.del\",y=(function(t,e){if(\"function\"!=typeof e&&null!==e)throw new TypeError(\"Super expression must either be null or a function, not \"+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(b,t.Component),function(t,e,n){e&&i(t.prototype,e),n&&i(t,n)}(b,[{key:\"componentDidMount\",value:function(){this.getIsReformList(),this.getList()}},{key:\"componentWillUnmount\",value:function(){this.setState=function(t,e){}}},{key:\"getIsReformList\",value:function(){var t=this;(0,u.post)({url:\"v2500Reform/queryIsReformList\",success:function(e){var n=e.map(function(t){return t.selectItem});t.setState({isReformList:n})}})}},{key:\"getSearchFormOptions\",value:function(){return[{type:\"Input\",label:\"机尾号\",name:\"tailNr\",span:6,length:3,placeholder:\"例：B-3056\"}]}},{key:\"getFormOptions\",value:function(){var t=this.state,e=t.currentAction,n=t.currentData,a=t.isReformList,o=\"add\"==e?{}:n,i=[{type:\"Input\",label:\"机尾号\",name:\"tailNr\",span:24,options:{initialValue:o.tailNr,rules:[{required:!0,message:\"机尾号不可为空！\"}]}},{type:\"Select\",label:\"AIMS软件是否升级到BP17B\",name:\"ifBp17b\",list:a,span:24,isHasAllSelect:!1,options:{initialValue:o.ifBp17b,rules:[{required:!0,message:\"AIMS软件是否升级到BP17B不可为空！\"}]}},{type:\"TextArea\",label:\"备注\",name:\"remark\",span:24,options:{initialValue:o.remark}}];return\"edit\"==e&&(i[0].disabled=!0),i}},{key:\"render\",value:function(){var e=this,n=this.state,a=n.table,o=n.modalOkBtnLoading,i=n.currentAction,s=n.selectedRowKeys,r=n.authorityList,c=this.getSearchFormOptions(),u={aligin:\"left\",span:6,list:[{text:\"查询\",options:\"queryOpt\",event:this.search}]},d={table:a,onChange:this.getList,columns:this.columns,rowSelection:{selectedRowKeys:s,onChange:function(t,n){e.onChecked(t,n)}}},p={options:{title:\"add\"==i?\"新增\":\"edit\"==i?\"修改\":\"\",okButtonProps:{loading:o}},onRef:function(t){e.modal=t},ok:this.submit.bind(this)},m=this.getFormOptions();return t.createElement(l.CardCommon,null,r&&t.createElement(l.CommonForm,{options:c,btnOptions:u,wrappedComponentRef:function(t){t&&t.props&&t.props.form&&(e.searcForm=t.props.form)}}),t.createElement(\"div\",{className:\"buttons\"},t.createElement(l.CommonBtns,{options:{shape:\"round\",size:\"small\"},btns:this.state.btns})),r&&t.createElement(l.CommonTable,{options:d,onChecked:this.onChecked}),!r&&t.createElement(\"div\",{className:\"no-authority-box\"},\"无权限查看\"),t.createElement(l.CommonModal,p,t.createElement(\"div\",{className:\"form-grid-8\",style:{paddingLeft:\"30px\",paddingRight:\"60px\"}},t.createElement(l.CommonForm,{options:m,wrappedComponentRef:function(t){t&&t.props&&t.props.form&&(e.form=t.props.form)}}))))}}]),b);function b(t){!function(t,e){if(!(t instanceof b))throw new TypeError(\"Cannot call a class as a function\")}(this);var e=function(t,e){if(!t)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!e||\"object\"!=typeof e&&\"function\"!=typeof e?t:e}(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,t));return e.getList=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=e.state.table;n.setPage(t);var a=n.getParmaData();(0,u.post)({url:\"ndTail/queryNdTailListByParam\",data:a,success:function(t){if(t&&t.rows){var o=t.rows.map(function(t,e){return t.index=(a.pageNum-1)*a.pageSize+e+1,t});n.setPage({dataList:o,total:t.total,pageNum:a.pageNum,pageSize:a.pageSize}),e.setState({table:n,selectedRowKeys:[],selectedRows:[]})}}})},e.onChecked=function(t,n){e.setState({selectedRowKeys:t,selectedRows:n})},e.search=function(){e.searcForm.validateFields(function(t,n){t||(n=(0,c.handleInParams)(n),e.getList({params:n,pageNum:1}))})},e.add=function(t){t(),e.setState({currentAction:\"add\"}),e.modal.show()},e.edit=function(t){0==e.state.selectedRows.length?(t(),a.default.warning(\"必须选择一个选项才能编辑！\")):1<e.state.selectedRows.length?(t(),a.default.warning(\"只能选择一个选项！\")):(t(),e.setState({currentAction:\"edit\",currentData:e.state.selectedRows[0]}),e.modal.show())},e.submit=function(){e.setState({modalOkBtnLoading:!0}),e.form.validateFields(function(t,n){var o,i;t?e.setState({modalOkBtnLoading:!1}):(n=(0,c.handleInParams)(n),i=\"add\"==e.state.currentAction?(o=\"ndTail/addNdTail\",\"添加成功\"):(n.id=e.state.currentData.id,o=\"ndTail:updateNdTail\",\"修改成功\"),(0,u.post)({url:o,data:n,btn:function(){return e.setState({modalOkBtnLoading:!1})},success:function(t){a.default.success(i),e.modal.hide(),e.getList({pageNum:1})}}))})},e.del=function(t){if(0==e.state.selectedRows.length)t(),a.default.warning(\"请至少选择一行数据\");else{var n=e.state.selectedRows.map(function(t){return t.id}),o=e.state.selectedRows.map(function(t){return t.tailNr});m({title:\"确认删除机尾号为【\"+o.join(\"、\")+\"的ND黑屏数据】吗?\",okType:\"danger\",onOk:function(){(0,u.post)({url:\"ndTail:deleteNdTailInfo\",data:{ids:n},btn:t,success:function(t){a.default.success(\"删除成功\"),e.getList({pageNum:1})}})},onCancel:t})}},e.state={table:new d.default,selectedRowKeys:[],selectedRows:[],btns:[{name:\"新增\",id:f,icon:\"plus-circle\",onClick:e.add},{name:\"修改\",id:h,icon:\"edit\",onClick:e.edit},{name:\"删除\",id:g,icon:\"minus-circle\",onClick:e.del}].filter(function(e){return(0,c.isAuthority)(e.id,t.authority)}),modalOkBtnLoading:!1,currentAction:\"\",currentData:{},isReformList:[],authorityList:(0,c.isAuthority)(\"ndTailData.list\",t.authority)},e.columns=[{title:\"机尾号\",dataIndex:\"tailNr\"},{title:\"AIMS软件是否升级到BP17B\",dataIndex:\"ifBp17b\"},{title:\"备注\",dataIndex:\"remark\",isTooltip:!0},{title:\"更新人\",dataIndex:\"updateUser\"},{title:\"更新时间\",dataIndex:\"updateTime\"}],e.modal,e.form,e}e.default=(0,r.connect)(function(t){return{authority:t.authority}})((0,s.withRouter)(y))}).call(this,n(1))}}]);","extractedComments":[]}
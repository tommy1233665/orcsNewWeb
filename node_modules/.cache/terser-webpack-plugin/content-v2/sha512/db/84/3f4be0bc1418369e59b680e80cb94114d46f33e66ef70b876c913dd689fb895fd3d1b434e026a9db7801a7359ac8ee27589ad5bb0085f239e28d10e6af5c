{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{416:function(e,t,n){\"use strict\";(function(e){Object.defineProperty(t,\"__esModule\",{value:!0});var a=v(n(126)),i=v(n(11)),o=v(n(28)),s=v(n(178)),r=v(n(77)),l=v(n(36)),p=function(e,t,n){return t&&u(e.prototype,t),n&&u(e,n),e};function u(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,\"value\"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}n(141),n(142),n(27),n(176),n(76),n(35);var c=n(20),d=n(24),m=v(n(5)),f=n(25),h=n(23),y=n(22),g=v(n(32));function v(e){return e&&e.__esModule?e:{default:e}}function k(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}function C(e,t){if(!e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!t||\"object\"!=typeof t&&\"function\"!=typeof t?e:t}function b(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function, not \"+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var A=l.default.confirm,w=r.default.Search,E=s.default.TreeNode,x=s.default.DirectoryTree,S=\"dailyRiskTarget.add\",R=\"dailyRiskTarget.edit\",N=\"dailyRiskTarget.del\",T=(b(I,e.Component),p(I,[{key:\"componentDidMount\",value:function(){var e=this;this.getAllBranch(function(t){e.setState({allBranch:t}),e.getList()})}},{key:\"componentWillUnmount\",value:function(){this.setState=function(e,t){}}},{key:\"getAllBranch\",value:function(e){(0,y.post)({url:\"acfData/getAllBranch\",success:function(t){e&&e(t)}})}},{key:\"handleSearchParams\",value:function(e){var t=(0,h.handleInParams)(e);for(var n in t)if(\"startAndEnd\"==n&&2==t[n].length&&(t.startDt=(0,m.default)(t[n][0]).format(\"YYYY-MM-DD\"),t.endDt=(0,m.default)(t[n][1]).format(\"YYYY-MM-DD\"),delete t[n]),\"treeSelectCustom\"==n){for(var a in t[n].value)\"acftType\"==a&&(t[a]=t[n].value[a]);delete t[n]}return t}},{key:\"getSearchFormOptions\",value:function(){var e=this.state.allBranch.map(function(e){return e.branchCd});return[{type:\"Select\",label:\"风险值\",name:\"riskValue\",span:4,list:[{key:\"低\",text:\"低0-4.0\"},{key:\"中\",text:\"中4.1-7.0\"},{key:\"高\",text:\"高7.1-10\"}],length:3,isHasAllSelect:!1},{type:\"Input\",label:\"风险名称\",name:\"riskName\",span:4,length:4},{type:\"Input\",label:\"飞行机组\",name:\"fltCrew\",span:4,length:4},{type:\"Input\",label:\"目的地机场\",name:\"destArpt\",span:4,length:6},{type:\"Input\",label:\"航线代码\",name:\"routeCode\",span:4,length:4},{type:\"Select\",label:\"飞机所属公司\",name:\"branchCode\",span:4,list:e,length:6,isHasAllSelect:!1},{type:\"Input\",label:\"机尾号\",name:\"latestTailNr\",span:4,length:3},{type:\"Select\",label:\"维护部门\",name:\"maintenanceDept\",span:4,list:[\"运指中心\",\"信息中心\",\"安监部\",\"飞行总队\",\"机务工程部\"],length:4,isHasAllSelect:!1},{type:\"Input\",label:\"起飞机场\",name:\"depArpCd\",span:4,length:4},{type:\"Input\",label:\"目的地备降场\",name:\"destBjArpt\",span:4,length:6},{type:\"Select\",label:\"状态\",name:\"status\",span:4,list:[\"当前有效\",\"已失效\",\"全部\"],length:4,isHasAllSelect:!1},{type:\"Select\",label:\"航班所属公司\",name:\"fltBranchCode\",span:4,list:e,length:6,isHasAllSelect:!1},{type:\"Input\",label:\"更新人\",name:\"updateUser\",span:4,length:3},{type:\"RangePicker\",label:\"更新时间\",name:\"startAndEnd\",span:8,length:4},{type:\"TreeSelectCustom\",label:\"机型\",name:\"treeSelectCustom\",span:10,detailSpan:[8,16],length:2}]}},{key:\"render\",value:function(){var t=this,n=this.getSearchFormOptions(),a={aligin:\"right\",span:2,list:[{text:\"查询\",options:\"queryOpt\",event:this.search}]},i=this.state,o=i.table,s=i.selectedRowKeys,r=i.authorityList,l={columns:this.columns,table:o,scroll:{x:\"2360px\"},onRow:function(e){return{onDoubleClick:function(n){t.setState({currentAction:\"detail\",currentRow:e}),t.modal.show()}}},rowSelection:{selectedRowKeys:s,onChange:function(e,n){t.onChecked(e,n)}},onChange:this.getList},p={options:{title:(\"add\"==this.state.currentAction?\"新增\":\"edit\"==this.state.currentAction?\"修改\":\"查看\")+\"日常风险\",width:\"1000px\",bodyStyle:{height:\"500px\",overflow:\"auto\"},okButtonProps:{loading:!1}},onRef:function(e){t.modal=e},ok:this.submit.bind(this)};\"detail\"==this.state.currentAction&&(p.options.footer=null);var u=\"edit\"==this.state.currentAction?this.state.selectedRows[0]:\"detail\"==this.state.currentAction?this.state.currentRow:{};return e.createElement(f.CardCommon,null,r&&e.createElement(f.CommonForm,{options:n,btnOptions:a,wrappedComponentRef:function(e){e&&e.props&&e.props.form&&(t.searcForm=e.props.form)}}),e.createElement(\"div\",{className:\"buttons\"},e.createElement(f.CommonBtns,{options:{shape:\"round\",size:\"small\"},btns:this.state.btns})),r&&e.createElement(f.CommonTable,{options:l,onChecked:this.onChecked}),!r&&e.createElement(\"div\",{className:\"no-authority-box\"},\"无权限查看\"),e.createElement(f.CommonModal,p,e.createElement(V,{allBranch:this.state.allBranch,datas:u,userInfo:this.props.userInfo,currentAction:this.state.currentAction,onRef:function(e){return t.editFrom=e}})))}}]),I);function I(t){k(this,I);var n=C(this,(I.__proto__||Object.getPrototypeOf(I)).call(this,t));return n.getList=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=n.state.table;t.setPage(e);var a=t.getParmaData();(0,y.post)({url:\"dailyAssociateRisk/queryDailyAssoRiskListByParam\",data:a,success:function(e){var i=e.rows.map(function(e,t){return e.index=(a.pageNum-1)*a.pageSize+t+1,e});t.setPage({dataList:i,total:e.total,pageNum:a.pageNum,pageSize:a.pageSize}),n.setState({table:t,selectedRowKeys:[],selectedRows:[]})}})},n.onChecked=function(e,t){n.setState({selectedRowKeys:e,selectedRows:t})},n.reset=function(){n.searcForm.resetFields(),n.search()},n.search=function(){event.preventDefault(),n.searcForm.validateFields(function(e,t){e||(t=n.handleSearchParams(t),n.getList({params:t,pageNum:1}))})},n.add=function(e){e(),n.setState({currentAction:\"add\"}),n.modal.show()},n.edit=function(e){0==n.state.selectedRows.length?(e(),o.default.warning(\"必须选择一个选项才能编辑！\")):1<n.state.selectedRows.length?(e(),o.default.warning(\"只能选择一个选项！\")):(e(),n.setState({currentAction:\"edit\"}),n.modal.show())},n.submit=function(){n.editFrom.submit(function(){n.modal.hide(),n.getList({pageNum:1})})},n.del=function(e){if(0==n.state.selectedRows.length)e(),o.default.warning(\"请至少选择一行数据\");else{var t=n.state.selectedRows.map(function(e){return e.id}),a=n.state.selectedRows.map(function(e){return e.riskName});A({title:\"确认删除【\"+a.join(\"、\")+\"】风险?\",okType:\"danger\",onOk:function(){(0,y.post)({url:\"dailyAssociateRisk/deleteDailyAssoRisksInfo\",data:{dailyAssoRiskIds:t},btn:e,success:function(e){o.default.success(\"删除成功\"),n.getList({pageNum:1})}})},onCancel:e})}},n.state={allBranch:[],searchFormOptions:[],table:new g.default,selectedRowKeys:[],selectedRows:[],currentRow:{},btns:[{name:\"新增\",id:S,icon:\"plus-circle\",onClick:n.add},{name:\"修改\",id:R,icon:\"edit\",onClick:n.edit},{name:\"删除\",id:N,icon:\"minus-circle\",onClick:n.del}].filter(function(e){return(0,h.isAuthority)(e.id,t.authority)}),authorityList:(0,h.isAuthority)(\"dailyRiskTarget.list\",t.authority),currentAction:\"\"},n.columns=[{title:\"序号\",dataIndex:\"index\",width:60,fixed:\"left\"},{title:\"风险名称\",dataIndex:\"riskName\",width:200,isTooltip:!0,fixed:\"left\"},{title:\"维护部门\",dataIndex:\"maintenanceDept\",width:100,isTooltip:!0},{title:\"风险值\",dataIndex:\"riskValue\",width:70},{title:\"起飞机场\",dataIndex:\"depArpName\",width:100},{title:\"目的地机场\",dataIndex:\"destArpName\",width:100},{title:\"目的地备降场\",dataIndex:\"destBjName\",width:120},{title:\"航线代码\",dataIndex:\"routeCode\",width:100},{title:\"飞行机组\",dataIndex:\"fltCrew\",width:100,isTooltip:!0},{title:\"机尾号\",dataIndex:\"latestTailNr\",width:100,isTooltip:!0},{title:\"阶段\",dataIndex:\"phase\",width:100},{title:\"风险提示\",dataIndex:\"riskTips\",width:200,isTooltip:!0},{title:\"附件\",dataIndex:\"riskTipsAppendix\",width:100,render:function(t){return t&&e.createElement(i.default,{type:\"check\"})}},{title:\"缓解措施\",dataIndex:\"mitigationMeasures\",width:200,isTooltip:!0},{title:\"附件\",dataIndex:\"mitigationMeasuresAppendix\",width:100,render:function(t){return t&&e.createElement(i.default,{type:\"check\"})}},{title:\"生效时间\",dataIndex:\"effectiveTime\",width:150},{title:\"失效时间\",dataIndex:\"invalidTime\",width:150},{title:\"更新人\",dataIndex:\"updateUser\",width:100},{title:\"更新时间\",dataIndex:\"updateTime\",width:150}],n.searcForm,n.modal,n.editFrom,n}var V=(b(O,e.Component),p(O,[{key:\"componentDidMount\",value:function(){this.props.onRef&&this.props.onRef(this,\"CommonModal\");var e=this.props.allBranch.map(function(e){return e.branchCd}),t=this.props.datas;this.setState({options1:this.getOptions1(t),options2:this.getOptions2(e,t),options3:this.getOptions3(e,t),options4:this.getOptions4(t),options5:this.getOptions5(t),options6:this.getOptions6(t),options7:this.getOptions7(t)})}},{key:\"componentWillUnmount\",value:function(){this.setState=function(e,t){}}},{key:\"getOptions1\",value:function(e){return[{type:\"GroupCustom\",label:\"机组\",name:\"fltCrew\",span:18,length:4,placeholder:\"员工号：205602\",variableTemp:\"fltCrew\",tooltip:\"多个机组请用英文分号;隔开\",options:{initialValue:e.fltCrew}}]}},{key:\"getOptions2\",value:function(e,t){var n=t.melType?t.melType:\"MEL\";return[{type:\"GroupCustom\",label:\"机尾号\",name:\"latestTailNr\",span:15,length:4,placeholder:\"如：B6138\",variableTemp:\"latestTailNr\",tooltip:\"多个机尾号请用英文分号;隔开\",options:{initialValue:t.latestTailNr,rules:[{validator:function(e,t,n){t.value.latestTailNr&&!/^0$|^[A-Za-z0-9]{5}$/.test(t.value.latestTailNr)&&n(\"输入规范的机尾号！\"),n()}}]}},{type:\"Select\",label:\"所属公司\",name:\"branchCode\",span:9,list:e,length:4,isHasAllSelect:!1,options:{initialValue:t.branchCode}},{type:\"TreeSelectCustom\",label:\"机型\",name:\"treeSelectCustom\",span:24,detailSpan:[10,14],length:4,options:{initialValue:{acftType:t.acftType,eqpType:t.eqpType}}},{type:\"Input\",label:\"MEL\",name:\"melInfo\",span:12,length:4,placeholder:\"如：32-51-01-01\",tooltip:\"多个MEL请用英文分号;隔开\",options:{initialValue:t.melInfo}},{type:\"Radio\",name:\"melType\",list:[\"MEL\",\"CDL\"],span:12,options:{initialValue:n}}]}},{key:\"getOptions3\",value:function(e,t){var n=[];return t.depArpCd&&n.push(\"depArpCd\"),t.destArpt&&n.push(\"destArpt\"),t.destBjArpt&&n.push(\"destBjArpt\"),[{type:\"GroupCustom\",label:\"机场\",name:\"arpName\",span:18,length:4,placeholder:\"四字码，如：ZGGG\",variableTemp:\"arpName\",tooltip:\"多个机场请用英文分号;隔开\",options:{initialValue:t.arpName}},{type:\"Radio\",name:\"depArpCdDestArptDestBjArpt\",list:[{key:\"depArpCd\",text:\"起飞机场\"},{key:\"destArpt\",text:\"目的地机场\"},{key:\"destBjArpt\",text:\"目的地备降场\"}],span:24,style:{marginLeft:\"5em\"},options:{initialValue:n}},{type:\"GroupCustom\",label:\"航班号\",name:\"fltNr\",span:18,length:4,placeholder:\"如：CSN348或CQN\",variableTemp:\"fltNr\",tooltip:\"多个航班号请用英文分号;隔开\",options:{initialValue:t.fltNr}},{type:\"Select\",label:\"所属公司\",name:\"fltBranchCode\",span:15,list:e,length:4,isHasAllSelect:!1,options:{initialValue:t.fltBranchCode}},{type:\"TextArea\",label:\"航路代码\",name:\"routeCode\",span:24,length:4,rows:2,placeholder:\"城市或公司航路：CANPEK或CANPEK01\",tooltip:\"多个航路代码请用英文分号;隔开\",options:{initialValue:t.routeCode}}]}},{key:\"getOptions4\",value:function(e){var t=[];return e.takeOff&&t.push(\"takeOff\"),e.cruise&&t.push(\"cruise\"),e.landing&&t.push(\"landing\"),[{type:\"Input\",label:\"风险名称\",name:\"riskName\",span:15,length:5,options:{initialValue:e.riskName,rules:[{required:!0,message:\"风险名称不可为空！\"}]}},{type:\"InputCheckboxCustom\",label:\"风险值\",name:\"riskValuePresentation\",span:19,length:5,placeholder:\"低0-4.0 中4.1-7.0 高7.1-10.0\",options:{initialValue:{riskValue:e.riskValue,presentation:e.presentation},rules:[{validator:function(e,t,n){t.value.riskValue&&!/^0$|^[1-9]\\d*$|^[1-9]\\d*.\\d{1}$|^0/.test(t.value.riskValue)&&n(\"最多保留1位小数！\"),n()}}]}},{type:\"Checkbox\",label:\"阶段\",name:\"takeOffCruiseLanding\",list:[{value:\"takeOff\",label:\"起飞\"},{value:\"cruise\",label:\"巡航\"},{value:\"landing\",label:\"着陆\"}],span:24,length:5,options:{initialValue:t,rules:[{required:!0,message:\"阶段不可为空！\"}]}}]}},{key:\"getOptions5\",value:function(e){return[{type:\"UploadFileCustom\",name:\"riskTipsAppendix\",options:{initialValue:e.riskTipsAppendix}},{type:\"TextArea\",name:\"riskTips\",span:24,rows:4,options:{initialValue:e.riskTips}}]}},{key:\"getOptions6\",value:function(e){return[{type:\"UploadFileCustom\",name:\"mitigationMeasuresAppendix\",options:{initialValue:e.mitigationMeasuresAppendix}},{type:\"TextArea\",name:\"mitigationMeasures\",span:24,rows:4,options:{initialValue:e.mitigationMeasures}}]}},{key:\"getOptions7\",value:function(e){return[{type:\"DatePicker\",label:\"生效时间\",name:\"effectiveTime\",span:24,length:5,options:{initialValue:(0,m.default)(e.effectiveTime),rules:[{required:!0,message:\"生效时间不可为空！\"}]}},{type:\"DatePicker\",label:\"失效时间\",name:\"invalidTime\",span:24,length:5,options:{initialValue:(0,m.default)(e.invalidTime),rules:[{required:!0,message:\"失效时间不可为空！\"}]}},{type:\"Select\",label:\"维护部门\",name:\"maintenanceDept\",span:12,list:[\"运指中心\",\"信息中心\",\"安监部\",\"飞行总队\",\"机务工程部\"],length:5,isHasAllSelect:!1,options:{initialValue:e.maintenanceDept,rules:[{required:!0,message:\"维护部门不可为空！\"}]}},{type:\"Select\",label:\"提醒对象\",name:\"reminder\",span:12,list:[\"签派\",\"机组\",\"全部\"],length:5,isHasAllSelect:!1,options:{initialValue:e.reminder,rules:[{required:!0,message:\"提醒对象不可为空！\"}]}}]}},{key:\"handleValues\",value:function(e,t,n){t.validateFields(function(t,a){if(!t){for(var i in a){if(\"fltCrew\"!=i&&\"latestTailNr\"!=i&&\"arpName\"!=i&&\"fltNr\"!=i&&\"riskTipsAppendix\"!=i&&\"mitigationMeasuresAppendix\"!=i||!a[i]||(a[i]=a[i].value),(\"treeSelectCustom\"==i||\"riskValuePresentation\"==i)&&a[i]&&a[i].value){for(var o in a[i].value)a[o]=a[i].value[o];delete a[i]}\"depArpCdDestArptDestBjArpt\"==i&&(a[i]&&(\"depArpCd\"==a[i]&&(a.depArpCd=!0),\"destArpt\"==a[i]&&(a.destArpt=!0),\"destBjArpt\"==a[i]&&(a.destBjArpt=!0)),a.depArpCd||(a.depArpCd=!1),a.destArpt||(a.destArpt=!1),a.destBjArpt||(a.destBjArpt=!1),delete a[i]),\"takeOffCruiseLanding\"==i&&(a[i]&&a[i].forEach(function(e,t){a[e]=!0}),a.takeOff||(a.takeOff=!1),a.cruise||(a.cruise=!1),a.landing||(a.landing=!1),delete a[i]),\"effectiveTime\"!=i&&\"invalidTime\"!=i||(a[i]=(0,m.default)(a[i]).format(\"YYYY-MM-DD HH:mm:ss\"))}Object.assign(e,a),n&&\"function\"==typeof n&&n()}})}},{key:\"render\",value:function(){var t=this,n=this.props.userInfo,a=void 0===n?{}:n;return e.createElement(\"div\",{className:\"daily-risk-target\"},e.createElement(\"div\",{className:\"update-user\"},\"更新人：\",a.userCode),e.createElement(\"div\",{className:\"fl\",style:{width:\"53%\"}},e.createElement(f.CardCommon,{title:\"机组配置\"},e.createElement(f.CommonForm,{options:this.state.options1,wrappedComponentRef:function(e){e&&e.props&&e.props.form&&(t.form1=e.props.form)}})),e.createElement(f.CardCommon,{title:\"飞机配置\"},e.createElement(f.CommonForm,{options:this.state.options2,wrappedComponentRef:function(e){e&&e.props&&e.props.form&&(t.form2=e.props.form)}})),e.createElement(f.CardCommon,{title:\"航班配置\"},e.createElement(f.CommonForm,{options:this.state.options3,wrappedComponentRef:function(e){e&&e.props&&e.props.form&&(t.form3=e.props.form)}})),e.createElement(\"div\",{className:\"mt20\"},e.createElement(f.CommonForm,{options:this.state.options4,wrappedComponentRef:function(e){e&&e.props&&e.props.form&&(t.form4=e.props.form)}}))),e.createElement(\"div\",{className:\"fr pl15\",style:{width:\"47%\"}},e.createElement(f.CardCommon,{title:\"其他配置\"},e.createElement(D,{datas:this.props.datas.rmItemIdList,onRef:function(e){return t.otherConfig=e}})),e.createElement(f.CardCommon,{title:\"风险提示\"},e.createElement(\"div\",{className:\"fixed-height\"},e.createElement(f.CommonForm,{options:this.state.options5,wrappedComponentRef:function(e){e&&e.props&&e.props.form&&(t.form5=e.props.form)}}))),e.createElement(f.CardCommon,{title:\"缓解措施\"},e.createElement(\"div\",{className:\"fixed-height\"},e.createElement(f.CommonForm,{options:this.state.options6,wrappedComponentRef:function(e){e&&e.props&&e.props.form&&(t.form6=e.props.form)}}))),e.createElement(\"div\",{className:\"mt20\"},e.createElement(f.CommonForm,{options:this.state.options7,wrappedComponentRef:function(e){e&&e.props&&e.props.form&&(t.form7=e.props.form)}}))))}}]),O);function O(e){k(this,O);var t=C(this,(O.__proto__||Object.getPrototypeOf(O)).call(this,e));return t.submit=function(e){var n={};t.handleValues(n,t.form1,function(){t.handleValues(n,t.form2,function(){t.handleValues(n,t.form3,function(){t.handleValues(n,t.form4,function(){t.handleValues(n,t.form5,function(){t.handleValues(n,t.form6,function(){t.handleValues(n,t.form7,function(){var a={};t.otherConfig.state.list.forEach(function(e,t){a[e.id]=e.riskValue}),n.rmItemIds=JSON.stringify(a).replace(\"{\",\"\").replace(\"}\",\"\");var i,s,r=(0,h.handleInParams)(n),l=t.props.currentAction;\"add\"==l?(i=\"dailyAssociateRisk/addDailyAssoRisksInfo\",s=\"添加\"):\"edit\"==l&&(i=\"dailyAssociateRisk/updateDailyAssoRisksInfo\",s=\"修改\",r.id=t.props.datas.id),i&&(0,y.post)({url:i,data:r,success:function(t){t.success?(o.default.success(s+\"成功！\"),e&&\"function\"==typeof e&&e()):o.default.error(s+\"失败！\")}})})})})})})})})},t.state={options1:[],options2:[],options3:[],options4:[],options5:[],options6:[],options7:[]},t.form1,t.form2,t.form3,t.form4,t.form5,t.form6,t.form7,t.otherConfig,t}var D=(b(F,e.Component),p(F,[{key:\"componentDidMount\",value:function(){if(this.props.onRef&&this.props.onRef(this),this.props.datas){var e=[];for(var t in this.props.datas){var n={id:t.substring(0,t.indexOf(\"*\")),path:t.substring(t.lastIndexOf(\"*\")+1),riskName:t.substring(t.lastIndexOf(\"-\")+1),riskValue:this.props.datas[t]};e.push(n)}this.setState({list:e})}}},{key:\"componentWillUnmount\",value:function(){this.setState=function(e,t){}}},{key:\"getFormOptions\",value:function(){return[{type:\"Hidden\",name:\"id\"},{type:\"Hidden\",name:\"path\"},{type:\"Input\",label:\"节点名称\",name:\"riskName\",span:24,length:5},{type:\"Input\",label:\"风险值>=\",name:\"riskValue\",span:24,length:5}]}},{key:\"onSelect\",value:function(e){this.form.setFieldsValue({id:e.id,path:e.path,riskName:e.name,riskValue:e.riskValue})}},{key:\"render\",value:function(){var t=this,n={options:{title:\"新增其他配置\"},onRef:function(e){t.modal=e},ok:this.submit.bind(this)},i=this.getFormOptions();return e.createElement(\"div\",{className:\"daily-risk-target-other flex\"},e.createElement(\"div\",{className:\"box\"},this.state.list.map(function(n,i){var o=\"\";n.path&&(o=n.path.substring(0,2));var s=e.createElement(\"div\",null,\"阶段：\",o,e.createElement(\"br\",null),\"父节点：\",n.path,e.createElement(\"br\",null),\"风险值 >= \",n.riskValue);return e.createElement(a.default,{title:s,key:i},e.createElement(\"div\",{className:n.active?\"active\":\"\",onClick:function(){return t.onClick(n)}},n.riskName))})),e.createElement(\"div\",{className:\"buttons\"},e.createElement(f.CommonBtns,{btns:this.btns})),e.createElement(f.CommonModal,n,e.createElement(\"div\",{className:\"daily-risk-target-other-modal clearfix\"},e.createElement(\"div\",{className:\"fl\"},e.createElement(B,{onSelect:function(e){return t.onSelect(e)}})),e.createElement(\"div\",{className:\"fr\"},e.createElement(f.CommonForm,{options:i,wrappedComponentRef:function(e){e&&e.props&&e.props.form&&(t.form=e.props.form)}})))))}}]),F);function F(e){k(this,F);var t=C(this,(F.__proto__||Object.getPrototypeOf(F)).call(this,e));return t.add=function(e){e(),t.modal.show()},t.submit=function(){t.form.validateFields(function(e,n){if(!e){var a=t.state.list;a.push(n),t.setState({list:a}),t.modal.hide()}})},t.onClick=function(e){var n=t.state.list.map(function(t,n){return t.active=t.id==e.id,t});t.setState({list:n,currentItem:e})},t.del=function(e){e();var n=t.state,a=n.list,i=n.currentItem,o=a.filter(function(e,t){return e.id!=i.id});t.setState({list:o,currentItem:{}})},t.state={list:[],currentItem:{}},t.btns=[{name:\"新增\",icon:\"plus\",onClick:t.add},{name:\"删除\",icon:\"minus\",onClick:t.del}],t.form,t}var B=(b(L,e.Component),p(L,[{key:\"componentDidMount\",value:function(){var e=this;this.getRiskValue(\"root\",function(t){return e.setState({treeData:t})})}},{key:\"componentWillUnmount\",value:function(){this.setState=function(e,t){}}},{key:\"getRiskValue\",value:function(e,t){(0,y.post)({url:\"rmItem/loadRmItemTreeChildren\",data:{parentId:e},success:function(e){var n=e.map(function(e){return{title:e.name,key:e.id,isLeaf:\"N\"!=e.isLeaf,datas:e}});t&&\"function\"==typeof t&&t(n)}})}},{key:\"treeReplace\",value:function(e,t,n){var a=this;return e&&e.forEach(function(e){e.key==n?e.children=t:e.children&&(e.children=a.treeReplace(e.children,t,n))}),e}},{key:\"onSearch\",value:function(e){var t=this;if(e){var n=this;(0,y.post)({url:\"rmItem/searchRmImte\",data:{name:e},success:function(a){if(a){var i=t.state.treeData,o=0;!function t(){var s=a[o].id;n.getRiskValue(s,function(r){i=n.treeReplace(i,r,s),++o<a.length?t():n.setState({treeData:i,expandedKeys:a.map(function(e){return e.id}),searchValue:e})})}()}}})}else o.default.warning(this.state.tip)}},{key:\"render\",value:function(){var t=this;return e.createElement(e.Fragment,null,e.createElement(w,{placeholder:this.state.tip,onSearch:function(e){return t.onSearch(e)}}),e.createElement(\"div\",{className:\"search-tree\"},e.createElement(x,{loadData:this.onLoadData,onExpand:this.onExpand,expandedKeys:this.state.expandedKeys,autoExpandParent:this.state.autoExpandParent,onSelect:this.onSelect},this.renderTreeNodes(this.state.treeData))))}}]),L);function L(t){k(this,L);var n=C(this,(L.__proto__||Object.getPrototypeOf(L)).call(this,t));return n.onLoadData=function(e){return new Promise(function(t){e.props.children?t():n.getRiskValue(e.props.dataRef.key,function(a){e.props.dataRef.children=a,n.setState({treeData:[].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(n.state.treeData))}),t()})})},n.onExpand=function(e,t){t.expanded,t.node,n.setState({expandedKeys:e})},n.renderTreeNodes=function(t){return t.map(function(t){var a=n.state.searchValue,i=t.title.indexOf(a),o=t.title.substr(0,i),s=t.title.substr(i+a.length),r=-1==i?t.title:e.createElement(e.Fragment,null,o,\" \",e.createElement(\"span\",{className:\"text-danger\"},a),\" \",s);return t.children?e.createElement(E,{title:r,key:t.key,isLeaf:t.isLeaf,dataRef:t},n.renderTreeNodes(t.children)):e.createElement(E,{title:r,key:t.key,isLeaf:t.isLeaf,dataRef:t})})},n.onSelect=function(e,t){if(0<t.selectedNodes.length){var a=t.selectedNodes[0].props.dataRef.datas;\"Y\"==a.isLeaf&&n.props.onSelect(a)}},n.state={treeData:[],tip:\"请输入节点名称\",expandedKeys:[],searchValue:\"\",autoExpandParent:!1,nodeData:{}},n}t.default=(0,d.connect)(function(e){return{userInfo:e.userInfo,authority:e.authority}})((0,c.withRouter)(T))}).call(this,n(1))}}]);","extractedComments":[]}